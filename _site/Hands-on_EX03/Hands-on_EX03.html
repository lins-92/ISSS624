<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ISSS624 - Hands-on Exercise 03</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="../site_libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ISSS624</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">Hands-on Exercise</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../Hands-on_EX01/Hands-on_EX01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_EX02/Hands-on_EX02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_EX03/Hands-on_EX03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">In-Class Exercise</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../In-class_EX01/In-class_EX01.html">
 <span class="dropdown-text">In-Class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_EX02/In-class_EX02.html">
 <span class="dropdown-text">In-Class Exercise 2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">Take-home Exercise</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../Take-home_EX01/Take-home_EX01.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">About</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#geographical-segmentation-with-spatially-constrained-clustering-techniques" id="toc-geographical-segmentation-with-spatially-constrained-clustering-techniques" class="nav-link active" data-scroll-target="#geographical-segmentation-with-spatially-constrained-clustering-techniques">Geographical Segmentation with Spatially Constrained Clustering Techniques</a>
  <ul class="collapse">
  <li><a href="#setting-up" id="toc-setting-up" class="nav-link" data-scroll-target="#setting-up">1. Setting up</a>
  <ul class="collapse">
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link" data-scroll-target="#load-packages">Load Packages</a></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data">Import Data</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">2. Exploratory Data Analysis</a></li>
  <li><a href="#correlation-analysis" id="toc-correlation-analysis" class="nav-link" data-scroll-target="#correlation-analysis">3. Correlation Analysis</a></li>
  <li><a href="#hierarchical-clustering" id="toc-hierarchical-clustering" class="nav-link" data-scroll-target="#hierarchical-clustering">4. Hierarchical Clustering</a>
  <ul class="collapse">
  <li><a href="#standardisation-of-data" id="toc-standardisation-of-data" class="nav-link" data-scroll-target="#standardisation-of-data">Standardisation of Data</a></li>
  <li><a href="#choosing-clustering-algorithm-and-number-of-clusters" id="toc-choosing-clustering-algorithm-and-number-of-clusters" class="nav-link" data-scroll-target="#choosing-clustering-algorithm-and-number-of-clusters">Choosing Clustering Algorithm and Number of Clusters</a></li>
  <li><a href="#visualising-clusters" id="toc-visualising-clusters" class="nav-link" data-scroll-target="#visualising-clusters">Visualising Clusters</a></li>
  </ul></li>
  <li><a href="#spatially-constrained-clustering" id="toc-spatially-constrained-clustering" class="nav-link" data-scroll-target="#spatially-constrained-clustering">5. Spatially Constrained Clustering</a>
  <ul class="collapse">
  <li><a href="#defining-the-neighbourhood" id="toc-defining-the-neighbourhood" class="nav-link" data-scroll-target="#defining-the-neighbourhood">Defining the Neighbourhood</a></li>
  <li><a href="#computing-the-minimum-spanning-tree" id="toc-computing-the-minimum-spanning-tree" class="nav-link" data-scroll-target="#computing-the-minimum-spanning-tree">Computing the Minimum Spanning Tree</a></li>
  <li><a href="#computing-spatially-constrained-clusters-using-skater-method" id="toc-computing-spatially-constrained-clusters-using-skater-method" class="nav-link" data-scroll-target="#computing-spatially-constrained-clusters-using-skater-method">Computing Spatially Constrained Clusters Using SKATER Method</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Hands-on Exercise 03</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="geographical-segmentation-with-spatially-constrained-clustering-techniques" class="level1">
<h1>Geographical Segmentation with Spatially Constrained Clustering Techniques</h1>
<p>In geobusiness and spatial policy, it is a common practice to delineate the market or planning area into homogeneous regions by using multivariate data. This exercise is to practice geographical segmentation techniques. Geographical segmentation delineates a homogeneous region by using geographically referenced multivariate data. We will also conduct aspatial hierarchical clustering on the dataset for comparison.</p>
<p>In this hands-on exercise, we are interested to delineate <a href="https://en.wikipedia.org/wiki/Shan_State">Shan State</a>, <a href="https://en.wikipedia.org/wiki/Myanmar">Myanmar</a> into homogeneous regions by using multiple Information and Communication technology (ICT) measures, namely: Radio, Television, Land line phone, Mobile phone, Computer, and Internet at home.</p>
<section id="setting-up" class="level2">
<h2 class="anchored" data-anchor-id="setting-up">1. Setting up</h2>
<section id="load-packages" class="level3">
<h3 class="anchored" data-anchor-id="load-packages">Load Packages</h3>
<p>There are the packages that will be used:</p>
<ul>
<li><p><strong>sf</strong>, <strong>rgdal</strong> and <strong>spdep</strong>: spatial data handling and spatial weights</p></li>
<li><p><strong>tidyverse</strong>: manipulation of attribute data and plotting visualisations (aspatial)</p></li>
<li><p><strong>tmap</strong>: creating map visualisations</p></li>
<li><p><strong>coorplot</strong>, <strong>ggpubr</strong>, and <strong>heatmaply</strong>: multivariate data analysis and visualisation</p></li>
<li><p><strong>cluster</strong>, <strong>factoextra</strong>, <strong>dendextend</strong> and <strong>clustGeo</strong>: cluster analysis</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(rgdal, spdep, tmap, sf, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               ggpubr, cluster, factoextra, NbClust,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               heatmaply, corrplot, psych, tidyverse,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               dendextend, GGally)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-data" class="level3">
<h3 class="anchored" data-anchor-id="import-data">Import Data</h3>
<p>The dataset used in this exercise is Myanmar Township Boundary GIS data and some infocomm data from the <strong>2014 Myanmar Population and Housing Census Myanmar</strong>. For this exercise, we are only using townships from the state of Shan (comprised of Shan (East), Shan (North) and Shan (South)).</p>
<p>The following code chunk imports the geospatial data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>shan_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial"</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">layer=</span><span class="st">"myanmar_township_boundaries"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ST <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Shan (East)"</span>, <span class="st">"Shan (North)"</span>, <span class="st">"Shan (South)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `myanmar_township_boundaries' from data source 
  `D:\lins-92\ISSS624\Hands-on_EX03\data\geospatial' using driver `ESRI Shapefile'
Simple feature collection with 330 features and 14 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 92.17275 ymin: 9.671252 xmax: 101.1699 ymax: 28.54554
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(shan_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 55
Columns: 15
$ OBJECTID   &lt;dbl&gt; 163, 203, 240, 106, 72, 40, 194, 159, 61, 124, 71, 155, 101…
$ ST         &lt;chr&gt; "Shan (North)", "Shan (South)", "Shan (South)", "Shan (Sout…
$ ST_PCODE   &lt;chr&gt; "MMR015", "MMR014", "MMR014", "MMR014", "MMR015", "MMR014",…
$ DT         &lt;chr&gt; "Mongmit", "Taunggyi", "Taunggyi", "Taunggyi", "Mongmit", "…
$ DT_PCODE   &lt;chr&gt; "MMR015D008", "MMR014D001", "MMR014D001", "MMR014D001", "MM…
$ TS         &lt;chr&gt; "Mongmit", "Pindaya", "Ywangan", "Pinlaung", "Mabein", "Kal…
$ TS_PCODE   &lt;chr&gt; "MMR015017", "MMR014006", "MMR014007", "MMR014009", "MMR015…
$ ST_2       &lt;chr&gt; "Shan State (North)", "Shan State (South)", "Shan State (So…
$ LABEL2     &lt;chr&gt; "Mongmit\n61072", "Pindaya\n77769", "Ywangan\n76933", "Pinl…
$ SELF_ADMIN &lt;chr&gt; NA, "Danu", "Danu", "Pa-O", NA, NA, NA, NA, NA, NA, NA, NA,…
$ ST_RG      &lt;chr&gt; "State", "State", "State", "State", "State", "State", "Stat…
$ T_NAME_WIN &lt;chr&gt; "rdk;rdwf", "yif;w,", "&amp;GmiH", "yifavmif;", "rbdrf;", "uavm…
$ T_NAME_M3  &lt;chr&gt; "မိုးမိတ်", "ပင်းတယ", "ရွာငံ", "ပင်လောင်း", "မဘိမ်း", "ကလော", "ဖယ်ခုံ", "…
$ AREA       &lt;dbl&gt; 2703.611, 629.025, 2984.377, 3396.963, 5034.413, 1456.624, …
$ geometry   &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((96.96001 23..., MULTIPOLYGON (…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(shan_sf) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"TS"</span>, <span class="at">size =</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Hands-on_EX03_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now for the attribute data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ict <span class="ot">&lt;-</span> <span class="fu">read_csv</span> (<span class="st">"data/aspatial/Shan-ICT.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 55 Columns: 11
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (4): District Pcode, District Name, Township Pcode, Township Name
dbl (7): Total households, Radio, Television, Land line phone, Mobile phone,...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(ict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 55
Columns: 11
$ `District Pcode`   &lt;chr&gt; "MMR014D001", "MMR014D001", "MMR014D001", "MMR014D0…
$ `District Name`    &lt;chr&gt; "Taunggyi", "Taunggyi", "Taunggyi", "Taunggyi", "Ta…
$ `Township Pcode`   &lt;chr&gt; "MMR014001", "MMR014002", "MMR014003", "MMR014004",…
$ `Township Name`    &lt;chr&gt; "Taunggyi", "Nyaungshwe", "Hopong", "Hsihseng", "Ka…
$ `Total households` &lt;dbl&gt; 82604, 42634, 24728, 32771, 41341, 17544, 18348, 25…
$ Radio              &lt;dbl&gt; 30176, 13801, 5083, 8087, 11607, 7324, 8890, 10048,…
$ Television         &lt;dbl&gt; 62388, 23640, 11272, 16568, 25285, 8862, 4781, 1635…
$ `Land line phone`  &lt;dbl&gt; 6736, 810, 799, 1042, 1739, 348, 219, 818, 728, 800…
$ `Mobile phone`     &lt;dbl&gt; 48461, 14973, 5192, 4755, 16900, 2849, 2207, 8321, …
$ Computer           &lt;dbl&gt; 6705, 669, 358, 325, 1225, 226, 81, 565, 351, 381, …
$ `Internet at home` &lt;dbl&gt; 9746, 1604, 631, 580, 1741, 136, 152, 556, 737, 316…</code></pre>
</div>
</div>
<p>The variables Radio, Television, Land line phone, Mobile phone, Computer and Internet at home are the absolute number of households within that township that have access that infocomm technology. For a meaningful comparision between townships, we need to convert these into proportions out of total household in the township. The following code chunk also changes some of the variable names so that the variable names match with the geospatial dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ict_derived <span class="ot">&lt;-</span> ict <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Radio</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">TV_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Television</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">LLPHONE_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Land line phone</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">MPHONE_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Mobile phone</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">COMPUTER_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Computer</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">INTERNET_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Internet at home</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">DT_PCODE</span><span class="st">`</span> <span class="ot">=</span><span class="st">`</span><span class="at">District Pcode</span><span class="st">`</span>,<span class="st">`</span><span class="at">DT</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">District Name</span><span class="st">`</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">TS_PCODE</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Township Pcode</span><span class="st">`</span>, <span class="st">`</span><span class="at">TS</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Township Name</span><span class="st">`</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">TT_HOUSEHOLDS</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">RADIO</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Radio</span><span class="st">`</span>, <span class="st">`</span><span class="at">TV</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Television</span><span class="st">`</span>, </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">LLPHONE</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Land line phone</span><span class="st">`</span>, <span class="st">`</span><span class="at">MPHONE</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Mobile phone</span><span class="st">`</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">COMPUTER</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Computer</span><span class="st">`</span>, <span class="st">`</span><span class="at">INTERNET</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Internet at home</span><span class="st">`</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Join the aspatial data to the geospatial data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>shan_sf <span class="ot">&lt;-</span> <span class="fu">left_join</span>(shan_sf, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                     ict_derived, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">by=</span><span class="fu">c</span>(<span class="st">"TS_PCODE"</span><span class="ot">=</span><span class="st">"TS_PCODE"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="exploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis">2. Exploratory Data Analysis</h2>
<p>We can plot the distribution of technology penetration for each type of infocomm technology. The follow code chunk creates a histogram of the absolute number of households that have adopted each technology type and then we use ggarrange() to combine these plots together.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>radio <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">RADIO</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>tv <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">TV</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)<span class="sc">+</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>llphone <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">LLPHONE</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)<span class="sc">+</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>mphone <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">MPHONE</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)<span class="sc">+</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>computer <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">COMPUTER</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)<span class="sc">+</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>internet <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">INTERNET</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)<span class="sc">+</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(radio, tv, llphone, mphone, computer, internet, </span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Hands-on_EX03_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We should also visualise the distribution of % technology penetration. Instead of creating multiple plots and combining them, we can also make use of the <code>facet_wrap()</code> function of ggplot2 to automatically generate the 6 graphs. First, we need to use <code>pivot_longer()</code> to pivot the data from wide to long format such that each observation corresponds to one technology type in a township.</p>
<p>One of the benefits of this method is that it automatically sets the x-axis to the same scale so it is easier to compare between each type of technology.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ict_prop <span class="ot">&lt;-</span> ict_derived <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span> <span class="fu">ends_with</span>(<span class="st">"_PR"</span>),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"tech"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to=</span><span class="st">"PR"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tech =</span> <span class="fu">str_replace</span>(tech, <span class="st">"_PR"</span>, <span class="st">""</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ict_prop,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>PR)) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(tech)) <span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Hands-on_EX03_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see that computers clearly have the lowest penetration rate with almost all townships having less than 10% of households with this technology. TV is the technology with the highest penetration rate.</p>
<p>We should also plot these spatially. We can plot all the penetration rates at the same time using the <code>tm_facets()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(shan_sf) <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_polygons</span>(<span class="fu">c</span>(<span class="st">"RADIO_PR"</span>, <span class="st">"TV_PR"</span>, <span class="st">"LLPHONE_PR"</span>, <span class="st">"MPHONE_PR"</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"COMPUTER_PR"</span>, <span class="st">"INTERNET_PR"</span>),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">style=</span><span class="st">"jenks"</span>) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_facets</span>(<span class="at">sync =</span> <span class="cn">TRUE</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>))<span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">outer.margins=</span><span class="dv">0</span>, <span class="at">asp=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Hands-on_EX03_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>We can see that technology penetration is not equal in the Shan state. Some townships have much higher technology penetration rates for all types of technology. Nonetheless, although a township may have very high penetration of one type of technology, it does not necessarily translate into high penetration rate of other technologies.</p>
</section>
<section id="correlation-analysis" class="level2">
<h2 class="anchored" data-anchor-id="correlation-analysis">3. Correlation Analysis</h2>
<p>Before conducting cluster analysis, we need to check for multicollinearity. Multicollinearity occurs when independent variables are linearly correlated. it is important to check for multicollinearity because it makes statistical inferences unreliable.</p>
<p>The cor() function computes the correlation coefficients of each pair of variables. We can then use the corrplot.mix() function from the corrplot function to plot a correlogram showing the pairwise correlation values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>cluster_vars.cor <span class="ot">=</span> <span class="fu">cor</span>(ict_derived[,<span class="dv">12</span><span class="sc">:</span><span class="dv">17</span>])</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot.mixed</span>(cluster_vars.cor,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> <span class="st">"ellipse"</span>, </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">upper =</span> <span class="st">"number"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.pos =</span> <span class="st">"lt"</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">diag =</span> <span class="st">"l"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.col =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Hands-on_EX03_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We typically consider any correlation coefficient more than 0.85 or less than -0.85 as highly correlated. As such, we should only use one of the COMPUTER_PR or INTERNET_PR for the subsequent analysis.</p>
</section>
<section id="hierarchical-clustering" class="level2">
<h2 class="anchored" data-anchor-id="hierarchical-clustering">4. Hierarchical Clustering</h2>
<p>First, we create a new dataframe with only the variables of interest. Note that we did not include INTERNET_PR because of the multicollinearity issue. Next, we assign the row names using the township names.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>cluster_vars <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ict_derived) <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"TS"</span>, <span class="st">"RADIO_PR"</span>, <span class="st">"TV_PR"</span>, <span class="st">"LLPHONE_PR"</span>, <span class="st">"MPHONE_PR"</span>, <span class="st">"COMPUTER_PR"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(cluster_vars) <span class="ot">&lt;-</span> cluster_vars<span class="sc">$</span><span class="st">"TS"</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cluster_vars,<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   TS RADIO_PR    TV_PR LLPHONE_PR MPHONE_PR COMPUTER_PR
Taunggyi     Taunggyi 36.53092 75.52661   8.154569  58.66665   8.1170403
Nyaungshwe Nyaungshwe 32.37088 55.44870   1.899892  35.11986   1.5691701
Hopong         Hopong 20.55565 45.58395   3.231155  20.99644   1.4477515
Hsihseng     Hsihseng 24.67731 50.55689   3.179641  14.50978   0.9917305
Kalaw           Kalaw 28.07624 61.16204   4.206478  40.87951   2.9631601
Pindaya       Pindaya 41.74647 50.51300   1.983584  16.23917   1.2881897
Ywangan       Ywangan 48.45215 26.05734   1.193591  12.02856   0.4414650
Lawksawk     Lawksawk 38.71017 63.00035   3.151366  32.05686   2.1766768
Pinlaung     Pinlaung 23.16499 54.17189   2.854454  24.94903   1.3762547
Pekon           Pekon 31.86118 53.58494   3.983270  21.48476   1.8970325</code></pre>
</div>
</div>
<p>We no longer need the TS column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>shan_ict <span class="ot">&lt;-</span> cluster_vars <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="standardisation-of-data" class="level3">
<h3 class="anchored" data-anchor-id="standardisation-of-data">Standardisation of Data</h3>
<p>Data standardisation is performed such that variables belong to approximately the same range. This is important in hierarchical clustering because it uses distance measures. A variable which has a larger magnitude will have a larger effect on the computed distance than other variables. Standardisation does not change the distribution of the data.</p>
<p>The following chunck applies min-max normalisation. It standardised values to a range of 0-1 with 0 being min value and 1 being the max value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>shan_ict.std <span class="ot">&lt;-</span> <span class="fu">normalize</span>(shan_ict)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(shan_ict.std)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    RADIO_PR          TV_PR          LLPHONE_PR       MPHONE_PR     
 Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:0.2544   1st Qu.:0.4600   1st Qu.:0.1123   1st Qu.:0.2199  
 Median :0.4097   Median :0.5523   Median :0.1948   Median :0.3846  
 Mean   :0.4199   Mean   :0.5416   Mean   :0.2703   Mean   :0.3972  
 3rd Qu.:0.5330   3rd Qu.:0.6750   3rd Qu.:0.3746   3rd Qu.:0.5608  
 Max.   :1.0000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  
  COMPUTER_PR     
 Min.   :0.00000  
 1st Qu.:0.09598  
 Median :0.17607  
 Mean   :0.23692  
 3rd Qu.:0.29868  
 Max.   :1.00000  </code></pre>
</div>
</div>
<p>The following chunk applies z-score normalisation which assumes that the underlying distribution of the data is a normal distribution. Normality should be checked before using this standardisation method.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>shan_ict.z <span class="ot">&lt;-</span> <span class="fu">scale</span>(shan_ict)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(shan_ict.z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            vars  n mean sd median trimmed  mad   min  max range  skew kurtosis
RADIO_PR       1 55    0  1  -0.04   -0.06 0.94 -1.85 2.55  4.40  0.48    -0.27
TV_PR          2 55    0  1   0.05    0.04 0.78 -2.47 2.09  4.56 -0.38    -0.23
LLPHONE_PR     3 55    0  1  -0.33   -0.15 0.68 -1.19 3.20  4.39  1.37     1.49
MPHONE_PR      4 55    0  1  -0.05   -0.06 1.01 -1.58 2.40  3.98  0.48    -0.34
COMPUTER_PR    5 55    0  1  -0.26   -0.18 0.64 -1.03 3.31  4.34  1.80     2.96
              se
RADIO_PR    0.13
TV_PR       0.13
LLPHONE_PR  0.13
MPHONE_PR   0.13
COMPUTER_PR 0.13</code></pre>
</div>
</div>
<p>The following code chunk plots the kernel density original and standardised versions of RADIO_PR. The underlying distribution has not changed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> RADIO_PR)) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Original Data"</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>shan_ict.std, </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>RADIO_PR)) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Min-Max Standardisation"</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">as.data.frame</span>(shan_ict.z), </span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>RADIO_PR)) <span class="sc">+</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Z-score Standardisation"</span>)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(r, s, z,</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Hands-on_EX03_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Standardisation is usually used if the variables have very different ranges. In this case, since all the variables are proportions, they are within the range of 0-100 and do not need to be standardised.</p>
</section>
<section id="choosing-clustering-algorithm-and-number-of-clusters" class="level3">
<h3 class="anchored" data-anchor-id="choosing-clustering-algorithm-and-number-of-clusters">Choosing Clustering Algorithm and Number of Clusters</h3>
<p>Hierarchical clustering uses distance measures to measure similarity within clusters and dissimilarity between clusters. As such, we first need to calculate the proximity matrix of distances between each observation. The method tells the algorithm what type of distance to compute.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>proxmat <span class="ot">&lt;-</span> <span class="fu">dist</span>(shan_ict, <span class="at">method =</span> <span class="st">'euclidean'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are many different agglomeration methods when performing hierarchical clustering (ie. how to measure similarity/dissimilarity between clusters). We can use the agnes() function of the cluster package to compute the agglomerative coefficient for each method to find the best method. Values closer to 1 suggest a strong clustering structure.</p>
<p>The following code chunk creates a function to extract the agglomerative coefficient for each method and applies it to the 4 different methods.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"average"</span>, <span class="st">"single"</span>, <span class="st">"complete"</span>, <span class="st">"ward"</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(m) <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"average"</span>, <span class="st">"single"</span>, <span class="st">"complete"</span>, <span class="st">"ward"</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>ac <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">agnes</span>(shan_ict, <span class="at">method =</span> x)<span class="sc">$</span>ac</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(m, ac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  average    single  complete      ward 
0.8131144 0.6628705 0.8950702 0.9427730 </code></pre>
</div>
</div>
<p>We can then use the <code>hclust()</code> to conduct the clustering using the specified method and plot the tree.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>hclust_ward <span class="ot">&lt;-</span> <span class="fu">hclust</span>(proxmat, <span class="at">method =</span> <span class="st">'ward.D'</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_ward)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Hands-on_EX03_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>However, this still does not tell us the optimal number of clusters. There are 3 methods that we can use:</p>
<ul>
<li><p><a href="https://en.wikipedia.org/wiki/Elbow_method_(clustering)">Elbow Method</a></p></li>
<li><p><a href="https://www.sciencedirect.com/science/article/pii/0377042787901257?via%3Dihub">Average Silhouette Method</a></p></li>
<li><p><a href="https://statweb.stanford.edu/~gwalther/gap">Gap Statistic Method</a></p></li>
</ul>
<section id="gap-statistic" class="level4">
<h4 class="anchored" data-anchor-id="gap-statistic">Gap Statistic</h4>
<p>The <a href="http://www.web.stanford.edu/~hastie/Papers/gap.pdf"><strong>gap statistic</strong></a> compares the total within intra-cluster variation for different values of k with their expected values under null reference distribution (distribution with no obvious clustering) of the data. The estimated optimal clusters (k) will be value that maximises the gap statistic, indicating that there is greatest difference between the clustering of the data and the clustering of a random dataset at that number of k.</p>
<p>clusGap() is used to compute the gap statistic. We can specify the clustering method and maximum number of clusters to consider. If performing k-means clustering, the nstart argument can be used to specify the number of sets of initial centroids. The firstmax method tells the algorithm to report the first local maximum. Because the null reference distribution is formed through Monte Carlo simulations, we need to specify the number of simulations (B=50 here).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>gap_stat <span class="ot">&lt;-</span> <span class="fu">clusGap</span>(shan_ict, </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">FUN =</span> hcut, </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">K.max =</span> <span class="dv">10</span>, </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">B =</span> <span class="dv">50</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the result</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gap_stat, <span class="at">method =</span> <span class="st">"firstmax"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Clustering Gap statistic ["clusGap"] from call:
clusGap(x = shan_ict, FUNcluster = hcut, K.max = 10, B = 50)
B=50 simulated reference sets, k = 1..10; spaceH0="scaledPCA"
 --&gt; Number of clusters (method 'firstmax'): 1
          logW   E.logW       gap     SE.sim
 [1,] 6.104544 6.378209 0.2736651 0.04460994
 [2,] 5.827444 6.048127 0.2206824 0.03880130
 [3,] 5.689680 5.899965 0.2102844 0.03362652
 [4,] 5.559639 5.778070 0.2184311 0.03784781
 [5,] 5.453876 5.675437 0.2215615 0.03897071
 [6,] 5.363009 5.585192 0.2221833 0.03973087
 [7,] 5.288334 5.503748 0.2154145 0.04054939
 [8,] 5.224095 5.429034 0.2049390 0.04198644
 [9,] 5.155439 5.358210 0.2027705 0.04421874
[10,] 5.074827 5.291273 0.2164465 0.04540947</code></pre>
</div>
</div>
<p>Next, we can visualise the plot by using <a href="https://rpkgs.datanovia.com/factoextra/reference/fviz_nbclust.html"><em>fviz_gap_stat()</em></a> of <a href="https://rpkgs.datanovia.com/factoextra/"><strong>factoextra</strong></a> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_gap_stat</span>(gap_stat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Hands-on_EX03_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Although the algorithm recommends 1 cluster as the optimum, this is not meaningful. We can instead use the next local maximum (k=6).</p>
</section>
<section id="elbow-method" class="level4">
<h4 class="anchored" data-anchor-id="elbow-method">Elbow Method</h4>
<p>The elbow plots the total within sum of squares (measure of the variability of the observations within each cluster) by each clustering over a range of k. At the elbow of the curve, dimishing marginal returns sets in, meaning that each subsequent increase in k results in less and less decrease in variability within each cluster (ie. clusters are getting more cohesive but at a slower rate). To prevent overfitting, we choose the k at the elbow of the curve.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(shan_ict, hcut, <span class="at">method =</span> <span class="st">"wss"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Hands-on_EX03_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The elbow appears to occur at 2 or 4.</p>
</section>
<section id="average-silhouette-method" class="level4">
<h4 class="anchored" data-anchor-id="average-silhouette-method">Average Silhouette Method</h4>
<p>The silhouette value is a measure of how similar an object is to its own cluster (cohesion) compared to other clusters (separation). The silhouette ranges from −1 to +1, where a high value indicates that the object is well matched to its own cluster and poorly matched to neighboring clusters. The average silhouette width is the average of the silhouette values of all the clusters. Maximising this value would give the number of clusters with the best intra-cluster cohesion and intra-cluster separation.</p>
<p>The <code>fviz_nbclust()</code> function of the <strong>factoextra</strong> package can use the average silhouette method. In the code chunk below, the <code>find_k()</code> function of the <strong>dendextend</strong> package uses average silhouette to recommend the optimal number of clusters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>num_k <span class="ot">&lt;-</span> <span class="fu">find_k</span>(hclust_ward)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(num_k)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Hands-on_EX03_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="visualising-clusters" class="level3">
<h3 class="anchored" data-anchor-id="visualising-clusters">Visualising Clusters</h3>
<p>Although all 3 methods have recommended different optimal number of clusters, let’s just use k=6 from the gap statistic method.</p>
<p>The follow code chunk creates borders around the clusters so we can see which townships are clustered together.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_ward, <span class="at">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(hclust_ward, </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">k =</span> <span class="dv">6</span>, </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">border =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Hands-on_EX03_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The heatmaply package can be used to build an interactive cluster heatmap to study the distribution of cluster variables at the same time. As the <code>heatmaply()</code> function takes a numeric matrix as input, we must convert the shan_ict object first.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>shan_ict_mat <span class="ot">&lt;-</span> <span class="fu">data.matrix</span>(shan_ict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following code chunk creates the interactive heatmap.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmaply</span>(<span class="fu">normalize</span>(shan_ict_mat),</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">Colv=</span><span class="cn">NA</span>,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dist_method =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">hclust_method =</span> <span class="st">"ward.D"</span>,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">seriate =</span> <span class="st">"OLO"</span>,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">colors =</span> Blues,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">k_row =</span> <span class="dv">6</span>,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">margins =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">200</span>,<span class="dv">60</span>,<span class="cn">NA</span>),</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontsize_row =</span> <span class="dv">4</span>,</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontsize_col =</span> <span class="dv">5</span>,</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">main=</span><span class="st">"Geographic Segmentation of Shan State by ICT indicators"</span>,</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"ICT Indicators"</span>,</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Townships of Shan State"</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-9eceb20dc2a931752ae4" style="width:100%;height:464px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-9eceb20dc2a931752ae4">{"x":{"data":[{"x":[1,2,3,4,5],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55],"z":[[0.116978282802357,0.129468002916701,0.22051676674467,0.384613999201764,0],[0.119071471357574,0.345093075355747,0.146680718622619,0.689156011292375,0.0306923094501804],[0.448112949126574,0.552259924114501,0.105215687600081,0.574129014267529,0.484807392774743],[0.394726524387261,0.646477338669936,0.19477119473094,0.398016081357507,0.307033923303471],[0.409738609943887,0.667785462581825,0.205939628052291,0.480784254803859,0.310457200410047],[0.560359050607694,0.682160053201915,0.219828980006303,0.532717729177229,0.295696949383387],[0.509783518401058,0.705849662481414,0.235277615529988,0.56572881621916,0.184217142327857],[0.445367826108455,0.648475186589583,0.400725374496756,0.525729584351687,0.325727661622098],[0.303006324046602,0.491472190827421,0.393413634291369,0.434988683676573,0.25539117902522],[0.285460565623123,0.653167734189465,0.351129977629807,0.321903369400093,0.274683722730117],[0.186896495593756,0.473621686944799,0.177547109767516,0.219017992119371,0.219238039033904],[0.262948885760044,0.600934420551276,0.105588681661233,0.309844721395711,0.32244406175046],[0.348384569046879,0.550413307218695,0.0132133117776572,0.330600515260223,0.280505026346822],[0.372116151704965,0.374968621142249,0.125060804628556,0.363502861923713,0.208286637250586],[0.382049084643175,0.495293243751349,0.165281214256075,0.332852029421132,0.126911060390332],[0.398090757930385,0.467734047728609,0.165251926083381,0.248272216763125,0.125663315216338],[0.463675071811737,0.480273489712105,0.0495176036018547,0.278454014117194,0.102240256271893],[0.454391396013767,0.585943534900779,0.144172529109699,0.304817572789695,0.117641144346071],[0.572059422162612,0.603028579702235,0.18200927177224,0.320846100415741,0.0996532209950878],[0.64202483918062,0.577864390148239,0.207338745441228,0.255258118966462,0.176074057695434],[0.469637019864802,0.49275331606036,0.336403906718691,0.326463285635126,0.199643002704722],[0.472437575771037,0.708306581316802,0.181528926899385,0.0981964513254065,0.186836974506664],[0.487021825059319,0.536184545909484,0.1623692849231,0.155474604691974,0.0744963103413769],[0.534163143993451,0.455760556744961,0.109548536966956,0.076155538926932,0.106925771850934],[0.437590296823069,0.464204461437082,0.110874787457869,0.0984403758574016,0.0985978869506665],[0.452636675796627,0.377797614010294,0.113655496814988,0.087769700588719,0.0640685752289788],[0.318011520183019,0.341693315696117,0.0982231808523387,0.141213400161106,0.0684535703034676],[0.303905626461184,0.295734660011411,0.122161422028907,0.220797228887767,0.0933576373559664],[0.125839377932289,0.271665869542777,0.146912934029539,0.111904436916593,0.0401203752296987],[0.1648181386917,0.163070599120654,0,0,0.050562923174398],[0.292778031055123,0,0.0180206673088627,0.0205146898168363,0.0573419602932674],[0.373857483778625,0.0995290076456666,0.0295999006447705,0.0262900696870936,0.00411244014094081],[0.481303842133627,0.142297506536797,0.0316650514783228,0.0125730639984617,0.030854020566576],[1,0.198958169425964,0.0512340297746273,0.119978472699802,0.0127547808735244],[0.855314778071883,0.535580295292679,0.0954404378234391,0.180215108968874,0.107759971325446],[0.789802194306684,0.707463556363309,0.160787084615829,0.406501651460893,0.207451038928221],[0.653022272989167,0.603518277436298,0.0907572048090615,0.450320578796944,0.139286867591449],[0.708316665856044,0.59451431070864,0.199599204123416,0.410008712407441,0.140105344905725],[0.828481634580948,0.533096150331035,0.222253044854804,0.49414581896158,0.245321426698747],[0.92441487443452,0.815706630141315,0.391551407290057,0.509561826896415,0.147799896773415],[0.554582082266574,0.857899290321775,0.667007964836916,0.411501854757207,0.135186676818821],[0.217633980358742,0.65209843040106,1,0.287788284692333,0.196437751553831],[0,0.23543567048956,0.932101354458042,0.401015569024513,0.0844217926569466],[0.109374929636258,0.623942179795541,0.622050632093837,0.618872994218249,0.107369754921389],[0.213613705288465,0.545980181296846,0.462858065656792,0.555883136314662,0.089979971244949],[0.229897462083034,0.606803420347241,0.441880181094265,0.645581402670746,0.238387780704064],[0.245824811756765,0.739869228579844,0.49811595358599,0.801230600000326,0.301658910303963],[0.0694967457544946,0.911879045679933,0.736263645750856,0.973268306969539,0.362172608061988],[0.131890106624229,0.766915045456104,0.471174055309928,0.742030952777325,0.665568016626695],[0.164829658497982,0.515216701198681,0.334570254727253,0.578557341817938,0.529033034945849],[0.531763581261235,0.718177853098515,0.338119112137043,0.645068858125427,0.496659923518642],[0.463214009841455,0.777367942019409,0.357599483272661,0.611463125655814,0.638873044291007],[0.742781450226171,0.879882415822816,0.440755998903745,0.787178952652566,0.873978634377844],[0.73856184642803,0.885602038677547,0.318801655583426,1,1],[0.334059480538155,1,0.765345298573847,0.967808669559975,0.987566110737814]],"text":[["row: Narphan<br>column: RADIO_PR<br>value: 0.116978","row: Narphan<br>column: TV_PR<br>value: 0.129468","row: Narphan<br>column: LLPHONE_PR<br>value: 0.220517","row: Narphan<br>column: MPHONE_PR<br>value: 0.384614","row: Narphan<br>column: COMPUTER_PR<br>value: 0.000000"],["row: Pangwaun<br>column: RADIO_PR<br>value: 0.119071","row: Pangwaun<br>column: TV_PR<br>value: 0.345093","row: Pangwaun<br>column: LLPHONE_PR<br>value: 0.146681","row: Pangwaun<br>column: MPHONE_PR<br>value: 0.689156","row: Pangwaun<br>column: COMPUTER_PR<br>value: 0.030692"],["row: Mongpan<br>column: RADIO_PR<br>value: 0.448113","row: Mongpan<br>column: TV_PR<br>value: 0.552260","row: Mongpan<br>column: LLPHONE_PR<br>value: 0.105216","row: Mongpan<br>column: MPHONE_PR<br>value: 0.574129","row: Mongpan<br>column: COMPUTER_PR<br>value: 0.484807"],["row: Nansang<br>column: RADIO_PR<br>value: 0.394727","row: Nansang<br>column: TV_PR<br>value: 0.646477","row: Nansang<br>column: LLPHONE_PR<br>value: 0.194771","row: Nansang<br>column: MPHONE_PR<br>value: 0.398016","row: Nansang<br>column: COMPUTER_PR<br>value: 0.307034"],["row: Kyaukme<br>column: RADIO_PR<br>value: 0.409739","row: Kyaukme<br>column: TV_PR<br>value: 0.667785","row: Kyaukme<br>column: LLPHONE_PR<br>value: 0.205940","row: Kyaukme<br>column: MPHONE_PR<br>value: 0.480784","row: Kyaukme<br>column: COMPUTER_PR<br>value: 0.310457"],["row: Kalaw<br>column: RADIO_PR<br>value: 0.560359","row: Kalaw<br>column: TV_PR<br>value: 0.682160","row: Kalaw<br>column: LLPHONE_PR<br>value: 0.219829","row: Kalaw<br>column: MPHONE_PR<br>value: 0.532718","row: Kalaw<br>column: COMPUTER_PR<br>value: 0.295697"],["row: Hseni<br>column: RADIO_PR<br>value: 0.509784","row: Hseni<br>column: TV_PR<br>value: 0.705850","row: Hseni<br>column: LLPHONE_PR<br>value: 0.235278","row: Hseni<br>column: MPHONE_PR<br>value: 0.565729","row: Hseni<br>column: COMPUTER_PR<br>value: 0.184217"],["row: Langkho<br>column: RADIO_PR<br>value: 0.445368","row: Langkho<br>column: TV_PR<br>value: 0.648475","row: Langkho<br>column: LLPHONE_PR<br>value: 0.400725","row: Langkho<br>column: MPHONE_PR<br>value: 0.525730","row: Langkho<br>column: COMPUTER_PR<br>value: 0.325728"],["row: Kunhing<br>column: RADIO_PR<br>value: 0.303006","row: Kunhing<br>column: TV_PR<br>value: 0.491472","row: Kunhing<br>column: LLPHONE_PR<br>value: 0.393414","row: Kunhing<br>column: MPHONE_PR<br>value: 0.434989","row: Kunhing<br>column: COMPUTER_PR<br>value: 0.255391"],["row: Laihka<br>column: RADIO_PR<br>value: 0.285461","row: Laihka<br>column: TV_PR<br>value: 0.653168","row: Laihka<br>column: LLPHONE_PR<br>value: 0.351130","row: Laihka<br>column: MPHONE_PR<br>value: 0.321903","row: Laihka<br>column: COMPUTER_PR<br>value: 0.274684"],["row: Monghsat<br>column: RADIO_PR<br>value: 0.186896","row: Monghsat<br>column: TV_PR<br>value: 0.473622","row: Monghsat<br>column: LLPHONE_PR<br>value: 0.177547","row: Monghsat<br>column: MPHONE_PR<br>value: 0.219018","row: Monghsat<br>column: COMPUTER_PR<br>value: 0.219238"],["row: Loilen<br>column: RADIO_PR<br>value: 0.262949","row: Loilen<br>column: TV_PR<br>value: 0.600934","row: Loilen<br>column: LLPHONE_PR<br>value: 0.105589","row: Loilen<br>column: MPHONE_PR<br>value: 0.309845","row: Loilen<br>column: COMPUTER_PR<br>value: 0.322444"],["row: Mongnai<br>column: RADIO_PR<br>value: 0.348385","row: Mongnai<br>column: TV_PR<br>value: 0.550413","row: Mongnai<br>column: LLPHONE_PR<br>value: 0.013213","row: Mongnai<br>column: MPHONE_PR<br>value: 0.330601","row: Mongnai<br>column: COMPUTER_PR<br>value: 0.280505"],["row: Mongton<br>column: RADIO_PR<br>value: 0.372116","row: Mongton<br>column: TV_PR<br>value: 0.374969","row: Mongton<br>column: LLPHONE_PR<br>value: 0.125061","row: Mongton<br>column: MPHONE_PR<br>value: 0.363503","row: Mongton<br>column: COMPUTER_PR<br>value: 0.208287"],["row: Hsipaw<br>column: RADIO_PR<br>value: 0.382049","row: Hsipaw<br>column: TV_PR<br>value: 0.495293","row: Hsipaw<br>column: LLPHONE_PR<br>value: 0.165281","row: Hsipaw<br>column: MPHONE_PR<br>value: 0.332852","row: Hsipaw<br>column: COMPUTER_PR<br>value: 0.126911"],["row: Hopong<br>column: RADIO_PR<br>value: 0.398091","row: Hopong<br>column: TV_PR<br>value: 0.467734","row: Hopong<br>column: LLPHONE_PR<br>value: 0.165252","row: Hopong<br>column: MPHONE_PR<br>value: 0.248272","row: Hopong<br>column: COMPUTER_PR<br>value: 0.125663"],["row: Monghsu<br>column: RADIO_PR<br>value: 0.463675","row: Monghsu<br>column: TV_PR<br>value: 0.480273","row: Monghsu<br>column: LLPHONE_PR<br>value: 0.049518","row: Monghsu<br>column: MPHONE_PR<br>value: 0.278454","row: Monghsu<br>column: COMPUTER_PR<br>value: 0.102240"],["row: Pinlaung<br>column: RADIO_PR<br>value: 0.454391","row: Pinlaung<br>column: TV_PR<br>value: 0.585944","row: Pinlaung<br>column: LLPHONE_PR<br>value: 0.144173","row: Pinlaung<br>column: MPHONE_PR<br>value: 0.304818","row: Pinlaung<br>column: COMPUTER_PR<br>value: 0.117641"],["row: Mongmit<br>column: RADIO_PR<br>value: 0.572059","row: Mongmit<br>column: TV_PR<br>value: 0.603029","row: Mongmit<br>column: LLPHONE_PR<br>value: 0.182009","row: Mongmit<br>column: MPHONE_PR<br>value: 0.320846","row: Mongmit<br>column: COMPUTER_PR<br>value: 0.099653"],["row: Pekon<br>column: RADIO_PR<br>value: 0.642025","row: Pekon<br>column: TV_PR<br>value: 0.577864","row: Pekon<br>column: LLPHONE_PR<br>value: 0.207339","row: Pekon<br>column: MPHONE_PR<br>value: 0.255258","row: Pekon<br>column: COMPUTER_PR<br>value: 0.176074"],["row: Kutkai<br>column: RADIO_PR<br>value: 0.469637","row: Kutkai<br>column: TV_PR<br>value: 0.492753","row: Kutkai<br>column: LLPHONE_PR<br>value: 0.336404","row: Kutkai<br>column: MPHONE_PR<br>value: 0.326463","row: Kutkai<br>column: COMPUTER_PR<br>value: 0.199643"],["row: Namtu<br>column: RADIO_PR<br>value: 0.472438","row: Namtu<br>column: TV_PR<br>value: 0.708307","row: Namtu<br>column: LLPHONE_PR<br>value: 0.181529","row: Namtu<br>column: MPHONE_PR<br>value: 0.098196","row: Namtu<br>column: COMPUTER_PR<br>value: 0.186837"],["row: Hsihseng<br>column: RADIO_PR<br>value: 0.487022","row: Hsihseng<br>column: TV_PR<br>value: 0.536185","row: Hsihseng<br>column: LLPHONE_PR<br>value: 0.162369","row: Hsihseng<br>column: MPHONE_PR<br>value: 0.155475","row: Hsihseng<br>column: COMPUTER_PR<br>value: 0.074496"],["row: Kyethi<br>column: RADIO_PR<br>value: 0.534163","row: Kyethi<br>column: TV_PR<br>value: 0.455761","row: Kyethi<br>column: LLPHONE_PR<br>value: 0.109549","row: Kyethi<br>column: MPHONE_PR<br>value: 0.076156","row: Kyethi<br>column: COMPUTER_PR<br>value: 0.106926"],["row: Tangyan<br>column: RADIO_PR<br>value: 0.437590","row: Tangyan<br>column: TV_PR<br>value: 0.464204","row: Tangyan<br>column: LLPHONE_PR<br>value: 0.110875","row: Tangyan<br>column: MPHONE_PR<br>value: 0.098440","row: Tangyan<br>column: COMPUTER_PR<br>value: 0.098598"],["row: Namhsan<br>column: RADIO_PR<br>value: 0.452637","row: Namhsan<br>column: TV_PR<br>value: 0.377798","row: Namhsan<br>column: LLPHONE_PR<br>value: 0.113655","row: Namhsan<br>column: MPHONE_PR<br>value: 0.087770","row: Namhsan<br>column: COMPUTER_PR<br>value: 0.064069"],["row: Mongyai<br>column: RADIO_PR<br>value: 0.318012","row: Mongyai<br>column: TV_PR<br>value: 0.341693","row: Mongyai<br>column: LLPHONE_PR<br>value: 0.098223","row: Mongyai<br>column: MPHONE_PR<br>value: 0.141213","row: Mongyai<br>column: COMPUTER_PR<br>value: 0.068454"],["row: Mongping<br>column: RADIO_PR<br>value: 0.303906","row: Mongping<br>column: TV_PR<br>value: 0.295735","row: Mongping<br>column: LLPHONE_PR<br>value: 0.122161","row: Mongping<br>column: MPHONE_PR<br>value: 0.220797","row: Mongping<br>column: COMPUTER_PR<br>value: 0.093358"],["row: Mongkhet<br>column: RADIO_PR<br>value: 0.125839","row: Mongkhet<br>column: TV_PR<br>value: 0.271666","row: Mongkhet<br>column: LLPHONE_PR<br>value: 0.146913","row: Mongkhet<br>column: MPHONE_PR<br>value: 0.111904","row: Mongkhet<br>column: COMPUTER_PR<br>value: 0.040120"],["row: Mawkmai<br>column: RADIO_PR<br>value: 0.164818","row: Mawkmai<br>column: TV_PR<br>value: 0.163071","row: Mawkmai<br>column: LLPHONE_PR<br>value: 0.000000","row: Mawkmai<br>column: MPHONE_PR<br>value: 0.000000","row: Mawkmai<br>column: COMPUTER_PR<br>value: 0.050563"],["row: Mongkaing<br>column: RADIO_PR<br>value: 0.292778","row: Mongkaing<br>column: TV_PR<br>value: 0.000000","row: Mongkaing<br>column: LLPHONE_PR<br>value: 0.018021","row: Mongkaing<br>column: MPHONE_PR<br>value: 0.020515","row: Mongkaing<br>column: COMPUTER_PR<br>value: 0.057342"],["row: Manton<br>column: RADIO_PR<br>value: 0.373857","row: Manton<br>column: TV_PR<br>value: 0.099529","row: Manton<br>column: LLPHONE_PR<br>value: 0.029600","row: Manton<br>column: MPHONE_PR<br>value: 0.026290","row: Manton<br>column: COMPUTER_PR<br>value: 0.004112"],["row: Matman<br>column: RADIO_PR<br>value: 0.481304","row: Matman<br>column: TV_PR<br>value: 0.142298","row: Matman<br>column: LLPHONE_PR<br>value: 0.031665","row: Matman<br>column: MPHONE_PR<br>value: 0.012573","row: Matman<br>column: COMPUTER_PR<br>value: 0.030854"],["row: Ywangan<br>column: RADIO_PR<br>value: 1.000000","row: Ywangan<br>column: TV_PR<br>value: 0.198958","row: Ywangan<br>column: LLPHONE_PR<br>value: 0.051234","row: Ywangan<br>column: MPHONE_PR<br>value: 0.119978","row: Ywangan<br>column: COMPUTER_PR<br>value: 0.012755"],["row: Pindaya<br>column: RADIO_PR<br>value: 0.855315","row: Pindaya<br>column: TV_PR<br>value: 0.535580","row: Pindaya<br>column: LLPHONE_PR<br>value: 0.095440","row: Pindaya<br>column: MPHONE_PR<br>value: 0.180215","row: Pindaya<br>column: COMPUTER_PR<br>value: 0.107760"],["row: Lawksawk<br>column: RADIO_PR<br>value: 0.789802","row: Lawksawk<br>column: TV_PR<br>value: 0.707464","row: Lawksawk<br>column: LLPHONE_PR<br>value: 0.160787","row: Lawksawk<br>column: MPHONE_PR<br>value: 0.406502","row: Lawksawk<br>column: COMPUTER_PR<br>value: 0.207451"],["row: Nyaungshwe<br>column: RADIO_PR<br>value: 0.653022","row: Nyaungshwe<br>column: TV_PR<br>value: 0.603518","row: Nyaungshwe<br>column: LLPHONE_PR<br>value: 0.090757","row: Nyaungshwe<br>column: MPHONE_PR<br>value: 0.450321","row: Nyaungshwe<br>column: COMPUTER_PR<br>value: 0.139287"],["row: Nawnghkio<br>column: RADIO_PR<br>value: 0.708317","row: Nawnghkio<br>column: TV_PR<br>value: 0.594514","row: Nawnghkio<br>column: LLPHONE_PR<br>value: 0.199599","row: Nawnghkio<br>column: MPHONE_PR<br>value: 0.410009","row: Nawnghkio<br>column: COMPUTER_PR<br>value: 0.140105"],["row: Monghpyak<br>column: RADIO_PR<br>value: 0.828482","row: Monghpyak<br>column: TV_PR<br>value: 0.533096","row: Monghpyak<br>column: LLPHONE_PR<br>value: 0.222253","row: Monghpyak<br>column: MPHONE_PR<br>value: 0.494146","row: Monghpyak<br>column: COMPUTER_PR<br>value: 0.245321"],["row: Mabein<br>column: RADIO_PR<br>value: 0.924415","row: Mabein<br>column: TV_PR<br>value: 0.815707","row: Mabein<br>column: LLPHONE_PR<br>value: 0.391551","row: Mabein<br>column: MPHONE_PR<br>value: 0.509562","row: Mabein<br>column: COMPUTER_PR<br>value: 0.147800"],["row: Mongyawng<br>column: RADIO_PR<br>value: 0.554582","row: Mongyawng<br>column: TV_PR<br>value: 0.857899","row: Mongyawng<br>column: LLPHONE_PR<br>value: 0.667008","row: Mongyawng<br>column: MPHONE_PR<br>value: 0.411502","row: Mongyawng<br>column: COMPUTER_PR<br>value: 0.135187"],["row: Kunlong<br>column: RADIO_PR<br>value: 0.217634","row: Kunlong<br>column: TV_PR<br>value: 0.652098","row: Kunlong<br>column: LLPHONE_PR<br>value: 1.000000","row: Kunlong<br>column: MPHONE_PR<br>value: 0.287788","row: Kunlong<br>column: COMPUTER_PR<br>value: 0.196438"],["row: Konkyan<br>column: RADIO_PR<br>value: 0.000000","row: Konkyan<br>column: TV_PR<br>value: 0.235436","row: Konkyan<br>column: LLPHONE_PR<br>value: 0.932101","row: Konkyan<br>column: MPHONE_PR<br>value: 0.401016","row: Konkyan<br>column: COMPUTER_PR<br>value: 0.084422"],["row: Mongyang<br>column: RADIO_PR<br>value: 0.109375","row: Mongyang<br>column: TV_PR<br>value: 0.623942","row: Mongyang<br>column: LLPHONE_PR<br>value: 0.622051","row: Mongyang<br>column: MPHONE_PR<br>value: 0.618873","row: Mongyang<br>column: COMPUTER_PR<br>value: 0.107370"],["row: Mongmao<br>column: RADIO_PR<br>value: 0.213614","row: Mongmao<br>column: TV_PR<br>value: 0.545980","row: Mongmao<br>column: LLPHONE_PR<br>value: 0.462858","row: Mongmao<br>column: MPHONE_PR<br>value: 0.555883","row: Mongmao<br>column: COMPUTER_PR<br>value: 0.089980"],["row: Hopang<br>column: RADIO_PR<br>value: 0.229897","row: Hopang<br>column: TV_PR<br>value: 0.606803","row: Hopang<br>column: LLPHONE_PR<br>value: 0.441880","row: Hopang<br>column: MPHONE_PR<br>value: 0.645581","row: Hopang<br>column: COMPUTER_PR<br>value: 0.238388"],["row: Namhkan<br>column: RADIO_PR<br>value: 0.245825","row: Namhkan<br>column: TV_PR<br>value: 0.739869","row: Namhkan<br>column: LLPHONE_PR<br>value: 0.498116","row: Namhkan<br>column: MPHONE_PR<br>value: 0.801231","row: Namhkan<br>column: COMPUTER_PR<br>value: 0.301659"],["row: Laukkaing<br>column: RADIO_PR<br>value: 0.069497","row: Laukkaing<br>column: TV_PR<br>value: 0.911879","row: Laukkaing<br>column: LLPHONE_PR<br>value: 0.736264","row: Laukkaing<br>column: MPHONE_PR<br>value: 0.973268","row: Laukkaing<br>column: COMPUTER_PR<br>value: 0.362173"],["row: Mongla<br>column: RADIO_PR<br>value: 0.131890","row: Mongla<br>column: TV_PR<br>value: 0.766915","row: Mongla<br>column: LLPHONE_PR<br>value: 0.471174","row: Mongla<br>column: MPHONE_PR<br>value: 0.742031","row: Mongla<br>column: COMPUTER_PR<br>value: 0.665568"],["row: Pangsang<br>column: RADIO_PR<br>value: 0.164830","row: Pangsang<br>column: TV_PR<br>value: 0.515217","row: Pangsang<br>column: LLPHONE_PR<br>value: 0.334570","row: Pangsang<br>column: MPHONE_PR<br>value: 0.578557","row: Pangsang<br>column: COMPUTER_PR<br>value: 0.529033"],["row: Kengtung<br>column: RADIO_PR<br>value: 0.531764","row: Kengtung<br>column: TV_PR<br>value: 0.718178","row: Kengtung<br>column: LLPHONE_PR<br>value: 0.338119","row: Kengtung<br>column: MPHONE_PR<br>value: 0.645069","row: Kengtung<br>column: COMPUTER_PR<br>value: 0.496660"],["row: Lashio<br>column: RADIO_PR<br>value: 0.463214","row: Lashio<br>column: TV_PR<br>value: 0.777368","row: Lashio<br>column: LLPHONE_PR<br>value: 0.357599","row: Lashio<br>column: MPHONE_PR<br>value: 0.611463","row: Lashio<br>column: COMPUTER_PR<br>value: 0.638873"],["row: Taunggyi<br>column: RADIO_PR<br>value: 0.742781","row: Taunggyi<br>column: TV_PR<br>value: 0.879882","row: Taunggyi<br>column: LLPHONE_PR<br>value: 0.440756","row: Taunggyi<br>column: MPHONE_PR<br>value: 0.787179","row: Taunggyi<br>column: COMPUTER_PR<br>value: 0.873979"],["row: Tachileik<br>column: RADIO_PR<br>value: 0.738562","row: Tachileik<br>column: TV_PR<br>value: 0.885602","row: Tachileik<br>column: LLPHONE_PR<br>value: 0.318802","row: Tachileik<br>column: MPHONE_PR<br>value: 1.000000","row: Tachileik<br>column: COMPUTER_PR<br>value: 1.000000"],["row: Muse<br>column: RADIO_PR<br>value: 0.334059","row: Muse<br>column: TV_PR<br>value: 1.000000","row: Muse<br>column: LLPHONE_PR<br>value: 0.765345","row: Muse<br>column: MPHONE_PR<br>value: 0.967809","row: Muse<br>column: COMPUTER_PR<br>value: 0.987566"]],"colorscale":[[0,"#F7FBFF"],[0.00411244014094081,"#F6FAFE"],[0.0125730639984617,"#F4F9FE"],[0.0127547808735244,"#F4F9FE"],[0.0132133117776572,"#F4F9FE"],[0.0180206673088627,"#F3F8FD"],[0.0205146898168363,"#F3F8FD"],[0.0262900696870936,"#F1F7FD"],[0.0295999006447705,"#F0F6FC"],[0.0306923094501804,"#F0F6FC"],[0.030854020566576,"#F0F6FC"],[0.0316650514783228,"#F0F6FC"],[0.0401203752296987,"#EFF5FC"],[0.0495176036018547,"#ECF4FB"],[0.050562923174398,"#ECF4FB"],[0.0512340297746273,"#ECF4FB"],[0.0573419602932674,"#EBF3FB"],[0.0640685752289788,"#EAF2FA"],[0.0684535703034676,"#E9F2FA"],[0.0694967457544946,"#E8F1FA"],[0.0744963103413769,"#E8F1FA"],[0.076155538926932,"#E8F1FA"],[0.0844217926569466,"#E5EFF9"],[0.087769700588719,"#E5EFF9"],[0.089979971244949,"#E4EFF9"],[0.0907572048090615,"#E4EFF9"],[0.0933576373559664,"#E4EEF8"],[0.0954404378234391,"#E4EEF8"],[0.0981964513254065,"#E3EEF8"],[0.0982231808523387,"#E3EEF8"],[0.0984403758574016,"#E3EEF8"],[0.0985978869506665,"#E3EEF8"],[0.0995290076456666,"#E3EEF8"],[0.0996532209950878,"#E3EEF8"],[0.102240256271893,"#E2EDF8"],[0.105215687600081,"#E1EDF8"],[0.105588681661233,"#E1EDF8"],[0.106925771850934,"#E1EDF8"],[0.107369754921389,"#E1EDF8"],[0.107759971325446,"#E1EDF8"],[0.109374929636258,"#E1ECF7"],[0.109548536966956,"#E1ECF7"],[0.110874787457869,"#E1ECF7"],[0.111904436916593,"#E0ECF7"],[0.113655496814988,"#E0ECF7"],[0.116978282802357,"#DFEBF7"],[0.117641144346071,"#DFEBF7"],[0.119071471357574,"#DFEBF7"],[0.119978472699802,"#DEEBF7"],[0.122161422028907,"#DEEBF7"],[0.125060804628556,"#DDEAF6"],[0.125663315216338,"#DDEAF6"],[0.125839377932289,"#DDEAF6"],[0.126911060390332,"#DDEAF6"],[0.129468002916701,"#DDEAF6"],[0.131890106624229,"#DCE9F6"],[0.135186676818821,"#DCE9F6"],[0.139286867591449,"#DAE8F5"],[0.140105344905725,"#DAE8F5"],[0.141213400161106,"#DAE8F5"],[0.142297506536797,"#DAE8F5"],[0.144172529109699,"#DAE8F5"],[0.146680718622619,"#DAE8F5"],[0.146912934029539,"#DAE8F5"],[0.147799896773415,"#D9E7F5"],[0.155474604691974,"#D7E6F4"],[0.160787084615829,"#D7E6F4"],[0.1623692849231,"#D7E6F4"],[0.163070599120654,"#D6E5F4"],[0.1648181386917,"#D6E5F4"],[0.164829658497982,"#D6E5F4"],[0.165251926083381,"#D6E5F4"],[0.165281214256075,"#D6E5F4"],[0.176074057695434,"#D4E4F3"],[0.177547109767516,"#D4E4F3"],[0.180215108968874,"#D3E3F3"],[0.181528926899385,"#D3E3F3"],[0.18200927177224,"#D3E3F3"],[0.184217142327857,"#D2E3F3"],[0.186836974506664,"#D1E2F2"],[0.186896495593756,"#D1E2F2"],[0.19477119473094,"#D0E1F2"],[0.196437751553831,"#D0E1F2"],[0.198958169425964,"#CFE1F2"],[0.199599204123416,"#CFE1F2"],[0.199643002704722,"#CFE1F2"],[0.205939628052291,"#CEE0F1"],[0.207338745441228,"#CEE0F1"],[0.207451038928221,"#CEE0F1"],[0.208286637250586,"#CEE0F1"],[0.213613705288465,"#CDDFF1"],[0.217633980358742,"#CCDFF1"],[0.219017992119371,"#CBDEF0"],[0.219238039033904,"#CBDEF0"],[0.219828980006303,"#CBDEF0"],[0.22051676674467,"#CBDEF0"],[0.220797228887767,"#CBDEF0"],[0.222253044854804,"#CBDEF0"],[0.229897462083034,"#C9DDF0"],[0.235277615529988,"#C8DCEF"],[0.23543567048956,"#C8DCEF"],[0.238387780704064,"#C8DCEF"],[0.245321426698747,"#C6DBEF"],[0.245824811756765,"#C6DBEF"],[0.248272216763125,"#C6DBEF"],[0.255258118966462,"#C4DAEE"],[0.25539117902522,"#C4DAEE"],[0.262948885760044,"#C1D9ED"],[0.271665869542777,"#BFD8EC"],[0.274683722730117,"#BED7EC"],[0.278454014117194,"#BCD7EB"],[0.280505026346822,"#BBD6EB"],[0.285460565623123,"#BAD6EA"],[0.287788284692333,"#BAD6EA"],[0.292778031055123,"#B8D4EA"],[0.295696949383387,"#B7D4EA"],[0.295734660011411,"#B7D4EA"],[0.301658910303963,"#B5D3E9"],[0.303006324046602,"#B5D3E9"],[0.303905626461184,"#B5D3E9"],[0.304817572789695,"#B4D3E8"],[0.307033923303471,"#B3D3E8"],[0.309844721395711,"#B2D2E8"],[0.310457200410047,"#B2D2E8"],[0.318011520183019,"#B0D1E7"],[0.318801655583426,"#B0D1E7"],[0.320846100415741,"#AFD1E6"],[0.321903369400093,"#AFD1E6"],[0.32244406175046,"#AFD1E6"],[0.325727661622098,"#ADD0E6"],[0.326463285635126,"#ADD0E6"],[0.330600515260223,"#ACD0E6"],[0.332852029421132,"#ABCFE5"],[0.334059480538155,"#ABCFE5"],[0.334570254727253,"#ABCFE5"],[0.336403906718691,"#AACFE5"],[0.338119112137043,"#AACFE5"],[0.341693315696117,"#A8CEE4"],[0.345093075355747,"#A7CEE4"],[0.348384569046879,"#A6CDE3"],[0.351129977629807,"#A5CDE3"],[0.357599483272661,"#A3CCE3"],[0.362172608061988,"#A2CBE2"],[0.363502861923713,"#A1CBE2"],[0.372116151704965,"#9ECAE1"],[0.373857483778625,"#9ECAE1"],[0.374968621142249,"#9DC9E0"],[0.377797614010294,"#9CC9E0"],[0.382049084643175,"#9BC8E0"],[0.384613999201764,"#9AC7E0"],[0.391551407290057,"#97C6DF"],[0.393413634291369,"#96C6DF"],[0.394726524387261,"#96C5DF"],[0.398016081357507,"#94C5DF"],[0.398090757930385,"#94C4DE"],[0.400725374496756,"#93C4DE"],[0.401015569024513,"#93C4DE"],[0.406501651460893,"#91C2DE"],[0.409738609943887,"#90C2DE"],[0.410008712407441,"#8FC1DD"],[0.411501854757207,"#8FC1DD"],[0.434988683676573,"#85BCDB"],[0.437590296823069,"#84BBDB"],[0.440755998903745,"#83BBDB"],[0.441880181094265,"#82BADB"],[0.445367826108455,"#81B9DA"],[0.448112949126574,"#80B9DA"],[0.450320578796944,"#7FB8DA"],[0.452636675796627,"#7EB8DA"],[0.454391396013767,"#7DB8D9"],[0.455760556744961,"#7DB8D9"],[0.462858065656792,"#7AB6D9"],[0.463214009841455,"#7AB6D9"],[0.463675071811737,"#7AB6D9"],[0.464204461437082,"#79B6D9"],[0.467734047728609,"#78B5D8"],[0.469637019864802,"#77B4D8"],[0.471174055309928,"#77B4D8"],[0.472437575771037,"#76B4D8"],[0.473621686944799,"#75B3D8"],[0.480273489712105,"#73B2D7"],[0.480784254803859,"#72B1D7"],[0.481303842133627,"#72B1D7"],[0.484807392774743,"#71B1D7"],[0.487021825059319,"#70B1D7"],[0.491472190827421,"#6EB0D6"],[0.49275331606036,"#6EAFD6"],[0.49414581896158,"#6DAFD6"],[0.495293243751349,"#6CAFD6"],[0.496659923518642,"#6CAED6"],[0.49811595358599,"#6BAED6"],[0.509561826896415,"#67ABD4"],[0.509783518401058,"#67ABD4"],[0.515216701198681,"#66AAD4"],[0.525729584351687,"#62A8D2"],[0.529033034945849,"#61A7D2"],[0.531763581261235,"#60A6D1"],[0.532717729177229,"#60A6D1"],[0.533096150331035,"#60A6D1"],[0.534163143993451,"#60A6D1"],[0.535580295292679,"#5FA5D1"],[0.536184545909484,"#5FA5D1"],[0.545980181296846,"#5CA3D0"],[0.550413307218695,"#5AA3CF"],[0.552259924114501,"#59A2CF"],[0.554582082266574,"#59A2CF"],[0.555883136314662,"#58A1CE"],[0.560359050607694,"#57A0CE"],[0.56572881621916,"#559FCD"],[0.572059422162612,"#539DCC"],[0.574129014267529,"#529DCC"],[0.577864390148239,"#519CCC"],[0.578557341817938,"#509BCB"],[0.585943534900779,"#4F9BCB"],[0.59451431070864,"#4B98C9"],[0.600934420551276,"#4A97C9"],[0.603028579702235,"#4896C8"],[0.603518277436298,"#4896C8"],[0.606803420347241,"#4795C8"],[0.611463125655814,"#4694C7"],[0.618872994218249,"#4393C6"],[0.622050632093837,"#4292C6"],[0.623942179795541,"#4292C6"],[0.638873044291007,"#3E8EC4"],[0.64202483918062,"#3D8DC3"],[0.645068858125427,"#3D8DC3"],[0.645581402670746,"#3C8CC3"],[0.646477338669936,"#3C8CC3"],[0.648475186589583,"#3C8CC3"],[0.65209843040106,"#3B8BC2"],[0.653022272989167,"#3A8AC1"],[0.653167734189465,"#3A8AC1"],[0.665568016626695,"#3787C0"],[0.667007964836916,"#3787C0"],[0.667785462581825,"#3686C0"],[0.682160053201915,"#3282BE"],[0.689156011292375,"#3080BD"],[0.705849662481414,"#2C7CBB"],[0.707463556363309,"#2C7CBB"],[0.708306581316802,"#2B7BBA"],[0.708316665856044,"#2B7BBA"],[0.718177853098515,"#2979B9"],[0.736263645750856,"#2474B6"],[0.73856184642803,"#2474B6"],[0.739869228579844,"#2373B6"],[0.742030952777325,"#2373B6"],[0.742781450226171,"#2373B6"],[0.765345298573847,"#1E6DB2"],[0.766915045456104,"#1D6CB1"],[0.777367942019409,"#1B6AAF"],[0.787178952652566,"#1967AD"],[0.789802194306684,"#1967AD"],[0.801230600000326,"#1664AB"],[0.815706630141315,"#1360A7"],[0.828481634580948,"#115DA5"],[0.855314778071883,"#0C56A0"],[0.857899290321775,"#0B559F"],[0.873978634377844,"#08519C"],[0.879882415822816,"#08509A"],[0.885602038677547,"#084E97"],[0.911879045679933,"#08468D"],[0.92441487443452,"#084388"],[0.932101354458042,"#084185"],[0.967808669559975,"#083877"],[0.973268306969539,"#083775"],[0.987566110737814,"#08336F"],[1,"#08306B"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[1],"name":"99_306696ee48c8158f9b168eae66068fb5","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#F7FBFF"],[0.00334448160535117,"#F6FAFE"],[0.00668896321070234,"#F5F9FE"],[0.0100334448160535,"#F4F9FE"],[0.0133779264214047,"#F4F9FE"],[0.0167224080267559,"#F3F8FD"],[0.020066889632107,"#F3F8FD"],[0.0234113712374582,"#F2F7FD"],[0.0267558528428094,"#F1F7FD"],[0.0301003344481605,"#F0F6FC"],[0.0334448160535117,"#EFF6FC"],[0.0367892976588629,"#EFF6FC"],[0.040133779264214,"#EFF5FC"],[0.0434782608695652,"#EEF5FC"],[0.0468227424749164,"#EDF4FB"],[0.0501672240802676,"#ECF4FB"],[0.0535117056856187,"#ECF3FB"],[0.0568561872909699,"#ECF3FB"],[0.0602006688963211,"#EBF3FB"],[0.0635451505016722,"#EAF2FA"],[0.0668896321070234,"#E9F2FA"],[0.0702341137123746,"#E8F1FA"],[0.0735785953177257,"#E8F1FA"],[0.0769230769230769,"#E7F0F9"],[0.0802675585284281,"#E7F0F9"],[0.0836120401337793,"#E6F0F9"],[0.0869565217391304,"#E5EFF9"],[0.0903010033444816,"#E4EFF9"],[0.0936454849498328,"#E4EEF8"],[0.096989966555184,"#E3EEF8"],[0.100334448160535,"#E2EDF8"],[0.103678929765886,"#E2EDF8"],[0.107023411371237,"#E1EDF8"],[0.110367892976589,"#E1ECF7"],[0.11371237458194,"#E0ECF7"],[0.117056856187291,"#DFEBF7"],[0.120401337792642,"#DEEBF7"],[0.123745819397993,"#DDEAF6"],[0.127090301003344,"#DDEAF6"],[0.130434782608696,"#DDEAF6"],[0.133779264214047,"#DCE9F6"],[0.137123745819398,"#DBE9F6"],[0.140468227424749,"#DAE8F5"],[0.1438127090301,"#DAE8F5"],[0.147157190635451,"#D9E7F5"],[0.150501672240803,"#D9E7F5"],[0.153846153846154,"#D8E7F5"],[0.157190635451505,"#D7E6F4"],[0.160535117056856,"#D7E6F4"],[0.163879598662207,"#D6E5F4"],[0.167224080267559,"#D5E5F4"],[0.17056856187291,"#D5E5F4"],[0.173913043478261,"#D4E4F3"],[0.177257525083612,"#D4E4F3"],[0.180602006688963,"#D3E3F3"],[0.183946488294314,"#D2E3F3"],[0.187290969899666,"#D1E2F2"],[0.190635451505017,"#D1E2F2"],[0.193979933110368,"#D1E2F2"],[0.197324414715719,"#D0E1F2"],[0.20066889632107,"#CFE1F2"],[0.204013377926421,"#CEE0F1"],[0.207357859531773,"#CEE0F1"],[0.210702341137124,"#CDDFF1"],[0.214046822742475,"#CCDFF1"],[0.217391304347826,"#CCDFF1"],[0.220735785953177,"#CBDEF0"],[0.224080267558528,"#CBDEF0"],[0.22742474916388,"#CADDF0"],[0.230769230769231,"#C9DDF0"],[0.234113712374582,"#C8DCEF"],[0.237458193979933,"#C8DCEF"],[0.240802675585284,"#C8DCEF"],[0.244147157190635,"#C7DBEF"],[0.247491638795987,"#C6DBEF"],[0.250836120401338,"#C5DAEE"],[0.254180602006689,"#C4DAEE"],[0.25752508361204,"#C3D9EE"],[0.260869565217391,"#C2D9ED"],[0.264214046822742,"#C1D9ED"],[0.267558528428094,"#C0D8ED"],[0.270903010033445,"#BFD8EC"],[0.274247491638796,"#BED7EC"],[0.277591973244147,"#BCD7EB"],[0.280936454849498,"#BBD6EB"],[0.284280936454849,"#BBD6EB"],[0.287625418060201,"#BAD6EA"],[0.290969899665552,"#B9D5EA"],[0.294314381270903,"#B7D4EA"],[0.297658862876254,"#B6D4E9"],[0.301003344481605,"#B5D3E9"],[0.304347826086957,"#B4D3E8"],[0.307692307692308,"#B3D3E8"],[0.311036789297659,"#B2D2E8"],[0.31438127090301,"#B1D2E7"],[0.317725752508361,"#B0D1E7"],[0.321070234113712,"#AFD1E6"],[0.324414715719064,"#AED0E6"],[0.327759197324415,"#ACD0E6"],[0.331103678929766,"#ACD0E6"],[0.334448160535117,"#ABCFE5"],[0.337792642140468,"#AACFE5"],[0.341137123745819,"#A8CEE4"],[0.344481605351171,"#A7CEE4"],[0.347826086956522,"#A6CDE3"],[0.351170568561873,"#A5CDE3"],[0.354515050167224,"#A4CDE3"],[0.357859531772575,"#A3CCE3"],[0.361204013377926,"#A2CBE2"],[0.364548494983278,"#A1CBE2"],[0.367892976588629,"#A0CAE1"],[0.37123745819398,"#9FCAE1"],[0.374581939799331,"#9DC9E0"],[0.377926421404682,"#9CC9E0"],[0.381270903010033,"#9BC8E0"],[0.384615384615385,"#9AC7E0"],[0.387959866220736,"#98C7DF"],[0.391304347826087,"#97C6DF"],[0.394648829431438,"#96C5DF"],[0.397993311036789,"#94C5DF"],[0.40133779264214,"#93C4DE"],[0.404682274247492,"#92C3DE"],[0.408026755852843,"#90C2DE"],[0.411371237458194,"#8FC1DD"],[0.414715719063545,"#8DC0DD"],[0.418060200668896,"#8CC0DD"],[0.421404682274247,"#8BC0DD"],[0.424749163879599,"#89BFDC"],[0.42809364548495,"#88BEDC"],[0.431438127090301,"#87BDDC"],[0.434782608695652,"#85BCDB"],[0.438127090301003,"#84BBDB"],[0.441471571906354,"#82BADB"],[0.444816053511706,"#81BADB"],[0.448160535117057,"#80B9DA"],[0.451505016722408,"#7FB8DA"],[0.454849498327759,"#7DB8D9"],[0.45819397993311,"#7BB7D9"],[0.461538461538462,"#7AB6D9"],[0.464882943143813,"#79B5D8"],[0.468227424749164,"#78B5D8"],[0.471571906354515,"#77B4D8"],[0.474916387959866,"#75B3D8"],[0.478260869565217,"#73B2D7"],[0.481605351170569,"#72B1D7"],[0.48494983277592,"#71B1D7"],[0.488294314381271,"#6FB0D6"],[0.491638795986622,"#6EB0D6"],[0.494983277591973,"#6DAFD6"],[0.498327759197324,"#6BAED6"],[0.501672240802676,"#6AADD5"],[0.505016722408027,"#69ACD5"],[0.508361204013378,"#68ABD4"],[0.511705685618729,"#67ABD4"],[0.51505016722408,"#66AAD4"],[0.518394648829431,"#65AAD3"],[0.521739130434783,"#63A9D3"],[0.525083612040134,"#62A8D2"],[0.528428093645485,"#61A7D2"],[0.531772575250836,"#60A6D1"],[0.535117056856187,"#5FA6D1"],[0.538461538461538,"#5EA5D1"],[0.54180602006689,"#5DA4D0"],[0.545150501672241,"#5CA3D0"],[0.548494983277592,"#5AA3CF"],[0.551839464882943,"#59A2CF"],[0.555183946488294,"#58A1CE"],[0.558528428093645,"#58A1CE"],[0.561872909698997,"#56A0CE"],[0.565217391304348,"#559FCD"],[0.568561872909699,"#549ECD"],[0.57190635451505,"#539DCC"],[0.575250836120401,"#529CCC"],[0.578595317725752,"#509BCB"],[0.581939799331104,"#509BCB"],[0.585284280936455,"#4F9BCB"],[0.588628762541806,"#4E9ACA"],[0.591973244147157,"#4C99CA"],[0.595317725752508,"#4B98C9"],[0.598662207357859,"#4A97C9"],[0.602006688963211,"#4996C8"],[0.605351170568562,"#4896C8"],[0.608695652173913,"#4795C8"],[0.612040133779264,"#4694C7"],[0.615384615384615,"#4594C7"],[0.618729096989967,"#4393C6"],[0.622073578595318,"#4292C6"],[0.625418060200669,"#4292C6"],[0.62876254180602,"#4191C5"],[0.632107023411371,"#4090C5"],[0.635451505016722,"#3F8FC4"],[0.638795986622074,"#3E8EC4"],[0.642140468227425,"#3D8DC3"],[0.645484949832776,"#3C8CC3"],[0.648829431438127,"#3C8CC3"],[0.652173913043478,"#3B8BC2"],[0.655518394648829,"#3A8AC1"],[0.658862876254181,"#3989C1"],[0.662207357859532,"#3888C0"],[0.665551839464883,"#3787C0"],[0.668896321070234,"#3686BF"],[0.672240802675585,"#3585BF"],[0.675585284280936,"#3484BF"],[0.678929765886288,"#3383BE"],[0.682274247491639,"#3282BE"],[0.68561872909699,"#3181BD"],[0.688963210702341,"#3080BD"],[0.692307692307692,"#2F7FBC"],[0.695652173913043,"#2F7FBC"],[0.698996655518395,"#2E7EBC"],[0.702341137123746,"#2D7DBB"],[0.705685618729097,"#2C7CBB"],[0.709030100334448,"#2B7BBA"],[0.712374581939799,"#2A7AB9"],[0.71571906354515,"#2979B9"],[0.719063545150502,"#2979B9"],[0.722408026755853,"#2878B8"],[0.725752508361204,"#2777B8"],[0.729096989966555,"#2676B7"],[0.732441471571906,"#2575B7"],[0.735785953177257,"#2474B6"],[0.739130434782609,"#2474B6"],[0.74247491638796,"#2373B6"],[0.745819397993311,"#2272B5"],[0.749163879598662,"#2171B5"],[0.752508361204013,"#2070B4"],[0.755852842809364,"#1F6FB3"],[0.759197324414716,"#1E6EB2"],[0.762541806020067,"#1E6EB2"],[0.765886287625418,"#1E6DB2"],[0.769230769230769,"#1D6CB1"],[0.77257525083612,"#1C6BB0"],[0.775919732441472,"#1B6AAF"],[0.779264214046823,"#1A69AE"],[0.782608695652174,"#1A68AE"],[0.785953177257525,"#1A68AE"],[0.789297658862876,"#1967AD"],[0.792642140468227,"#1866AC"],[0.795986622073579,"#1765AB"],[0.79933110367893,"#1664AB"],[0.802675585284281,"#1663AA"],[0.806020066889632,"#1562A9"],[0.809364548494983,"#1562A9"],[0.812709030100334,"#1461A8"],[0.816053511705686,"#1360A7"],[0.819397993311037,"#135FA7"],[0.822742474916388,"#125EA6"],[0.826086956521739,"#115DA5"],[0.82943143812709,"#105CA4"],[0.832775919732441,"#105CA4"],[0.836120401337793,"#0F5BA3"],[0.839464882943144,"#0F5AA3"],[0.842809364548495,"#0E59A2"],[0.846153846153846,"#0D58A1"],[0.849498327759197,"#0C57A0"],[0.852842809364548,"#0C57A0"],[0.8561872909699,"#0C56A0"],[0.859531772575251,"#0B559F"],[0.862876254180602,"#0A549E"],[0.866220735785953,"#09539D"],[0.869565217391304,"#08529C"],[0.872909698996655,"#08519C"],[0.876254180602007,"#08519B"],[0.879598662207358,"#08509A"],[0.882943143812709,"#084F99"],[0.88628762541806,"#084E97"],[0.889632107023411,"#084C96"],[0.892976588628763,"#084B95"],[0.896321070234114,"#084A93"],[0.899665551839465,"#084A92"],[0.903010033444816,"#084990"],[0.906354515050167,"#08488F"],[0.909698996655518,"#08478E"],[0.91304347826087,"#08468C"],[0.916387959866221,"#08458B"],[0.919732441471572,"#08448A"],[0.923076923076923,"#084489"],[0.926421404682274,"#084388"],[0.929765886287625,"#084286"],[0.933110367892977,"#084185"],[0.936454849498328,"#084083"],[0.939799331103679,"#083F82"],[0.94314381270903,"#083E81"],[0.946488294314381,"#083E7F"],[0.949832775919732,"#083D7E"],[0.953177257525084,"#083C7D"],[0.956521739130435,"#083B7B"],[0.959866220735786,"#083A7A"],[0.963210702341137,"#083979"],[0.966555183946488,"#083978"],[0.969899665551839,"#083876"],[0.973244147157191,"#083775"],[0.976588628762542,"#083674"],[0.979933110367893,"#083572"],[0.983277591973244,"#083471"],[0.986622073578595,"#083370"],[0.989966555183946,"#08336F"],[0.993311036789298,"#08326D"],[0.996655518394649,"#08316C"],[1,"#08306B"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"thickness":23.04,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null},{"x":[1.09087788975901,1.09087788975901,null,1.09087788975901,0.500949721963311,null,0.500949721963311,0.500949721963311,null,0.500949721963311,0,null,0.500949721963311,0.500949721963311,null,0.500949721963311,0],"y":[45.609375,42.5,null,42.5,42.5,null,42.5,42,null,42,42,null,42.5,43,null,43,43],"text":["y: 1.09087789","y: 1.09087789",null,"y: 1.09087789","y: 1.09087789",null,"y: 0.50094972","y: 0.50094972",null,"y: 0.50094972","y: 0.50094972",null,"y: 0.50094972","y: 0.50094972",null,"y: 0.50094972","y: 0.50094972"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.09087788975901,1.09087788975901,null,1.09087788975901,0.731800222126064,null,0.731800222126064,0.731800222126064,null,0.731800222126064,0.691159533269081,null,0.691159533269081,0.691159533269081,null,0.691159533269081,0.380627098188748,null,0.380627098188748,0.380627098188748,null,0.380627098188748,0.255264316891836,null,0.255264316891836,0.255264316891836,null,0.255264316891836,0,null,0.255264316891836,0.255264316891836,null,0.255264316891836,0.185675404080306,null,0.185675404080306,0.185675404080306,null,0.185675404080306,0,null,0.185675404080306,0.185675404080306,null,0.185675404080306,0,null,0.380627098188748,0.380627098188748,null,0.380627098188748,0,null,0.691159533269081,0.691159533269081,null,0.691159533269081,0,null,0.731800222126064,0.731800222126064,null,0.731800222126064,0.466807582689693,null,0.466807582689693,0.466807582689693,null,0.466807582689693,0.358417482296683,null,0.358417482296683,0.358417482296683,null,0.358417482296683,0,null,0.358417482296683,0.358417482296683,null,0.358417482296683,0,null,0.466807582689693,0.466807582689693,null,0.466807582689693,0.173019976310583,null,0.173019976310583,0.173019976310583,null,0.173019976310583,0,null,0.173019976310583,0.173019976310583,null,0.173019976310583,0],"y":[45.609375,48.71875,null,48.71875,48.71875,null,48.71875,46.9375,null,46.9375,46.9375,null,46.9375,45.875,null,45.875,45.875,null,45.875,44.75,null,44.75,44.75,null,44.75,44,null,44,44,null,44.75,45.5,null,45.5,45.5,null,45.5,45,null,45,45,null,45.5,46,null,46,46,null,45.875,47,null,47,47,null,46.9375,48,null,48,48,null,48.71875,50.5,null,50.5,50.5,null,50.5,49.5,null,49.5,49.5,null,49.5,49,null,49,49,null,49.5,50,null,50,50,null,50.5,51.5,null,51.5,51.5,null,51.5,51,null,51,51,null,51.5,52,null,52,52],"text":["y: 1.09087789","y: 1.09087789",null,"y: 1.09087789","y: 1.09087789",null,"y: 0.73180022","y: 0.73180022",null,"y: 0.73180022","y: 0.73180022",null,"y: 0.69115953","y: 0.69115953",null,"y: 0.69115953","y: 0.69115953",null,"y: 0.38062710","y: 0.38062710",null,"y: 0.38062710","y: 0.38062710",null,"y: 0.25526432","y: 0.25526432",null,"y: 0.25526432","y: 0.25526432",null,"y: 0.25526432","y: 0.25526432",null,"y: 0.25526432","y: 0.25526432",null,"y: 0.18567540","y: 0.18567540",null,"y: 0.18567540","y: 0.18567540",null,"y: 0.18567540","y: 0.18567540",null,"y: 0.18567540","y: 0.18567540",null,"y: 0.38062710","y: 0.38062710",null,"y: 0.38062710","y: 0.38062710",null,"y: 0.69115953","y: 0.69115953",null,"y: 0.69115953","y: 0.69115953",null,"y: 0.73180022","y: 0.73180022",null,"y: 0.73180022","y: 0.73180022",null,"y: 0.46680758","y: 0.46680758",null,"y: 0.46680758","y: 0.46680758",null,"y: 0.35841748","y: 0.35841748",null,"y: 0.35841748","y: 0.35841748",null,"y: 0.35841748","y: 0.35841748",null,"y: 0.35841748","y: 0.35841748",null,"y: 0.46680758","y: 0.46680758",null,"y: 0.46680758","y: 0.46680758",null,"y: 0.17301998","y: 0.17301998",null,"y: 0.17301998","y: 0.17301998",null,"y: 0.17301998","y: 0.17301998",null,"y: 0.17301998","y: 0.17301998"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(125,176,221,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.05439722722438,1.05439722722438,null,1.05439722722438,0.47350573521867,null,0.47350573521867,0.47350573521867,null,0.47350573521867,0,null,0.47350573521867,0.47350573521867,null,0.47350573521867,0],"y":[37.859375,40.5,null,40.5,40.5,null,40.5,40,null,40,40,null,40.5,41,null,41,41],"text":["y: 1.05439723","y: 1.05439723",null,"y: 1.05439723","y: 1.05439723",null,"y: 0.47350574","y: 0.47350574",null,"y: 0.47350574","y: 0.47350574",null,"y: 0.47350574","y: 0.47350574",null,"y: 0.47350574","y: 0.47350574"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(134,184,117,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.05439722722438,1.05439722722438,null,1.05439722722438,0.659367031899142,null,0.659367031899142,0.659367031899142,null,0.659367031899142,0,null,0.659367031899142,0.659367031899142,null,0.659367031899142,0.366446818172613,null,0.366446818172613,0.366446818172613,null,0.366446818172613,0,null,0.366446818172613,0.366446818172613,null,0.366446818172613,0.257294381800551,null,0.257294381800551,0.257294381800551,null,0.257294381800551,0.202445065633869,null,0.202445065633869,0.202445065633869,null,0.202445065633869,0,null,0.202445065633869,0.202445065633869,null,0.202445065633869,0.128883042294223,null,0.128883042294223,0.128883042294223,null,0.128883042294223,0,null,0.128883042294223,0.128883042294223,null,0.128883042294223,0,null,0.257294381800551,0.257294381800551,null,0.257294381800551,0],"y":[37.859375,35.21875,null,35.21875,35.21875,null,35.21875,34,null,34,34,null,35.21875,36.4375,null,36.4375,36.4375,null,36.4375,35,null,35,35,null,36.4375,37.875,null,37.875,37.875,null,37.875,36.75,null,36.75,36.75,null,36.75,36,null,36,36,null,36.75,37.5,null,37.5,37.5,null,37.5,37,null,37,37,null,37.5,38,null,38,38,null,37.875,39,null,39,39],"text":["y: 1.05439723","y: 1.05439723",null,"y: 1.05439723","y: 1.05439723",null,"y: 0.65936703","y: 0.65936703",null,"y: 0.65936703","y: 0.65936703",null,"y: 0.65936703","y: 0.65936703",null,"y: 0.65936703","y: 0.65936703",null,"y: 0.36644682","y: 0.36644682",null,"y: 0.36644682","y: 0.36644682",null,"y: 0.36644682","y: 0.36644682",null,"y: 0.36644682","y: 0.36644682",null,"y: 0.25729438","y: 0.25729438",null,"y: 0.25729438","y: 0.25729438",null,"y: 0.20244507","y: 0.20244507",null,"y: 0.20244507","y: 0.20244507",null,"y: 0.20244507","y: 0.20244507",null,"y: 0.20244507","y: 0.20244507",null,"y: 0.12888304","y: 0.12888304",null,"y: 0.12888304","y: 0.12888304",null,"y: 0.12888304","y: 0.12888304",null,"y: 0.12888304","y: 0.12888304",null,"y: 0.25729438","y: 0.25729438",null,"y: 0.25729438","y: 0.25729438"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(199,167,108,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.59417446669873,1.59417446669873,null,1.59417446669873,0.614248456260233,null,0.614248456260233,0.614248456260233,null,0.614248456260233,0.275857868808986,null,0.275857868808986,0.275857868808986,null,0.275857868808986,0,null,0.275857868808986,0.275857868808986,null,0.275857868808986,0,null,0.614248456260233,0.614248456260233,null,0.614248456260233,0],"y":[49.9296875,54.25,null,54.25,54.25,null,54.25,53.5,null,53.5,53.5,null,53.5,53,null,53,53,null,53.5,54,null,54,54,null,54.25,55,null,55,55],"text":["y: 1.59417447","y: 1.59417447",null,"y: 1.59417447","y: 1.59417447",null,"y: 0.61424846","y: 0.61424846",null,"y: 0.61424846","y: 0.61424846",null,"y: 0.27585787","y: 0.27585787",null,"y: 0.27585787","y: 0.27585787",null,"y: 0.27585787","y: 0.27585787",null,"y: 0.27585787","y: 0.27585787",null,"y: 0.61424846","y: 0.61424846",null,"y: 0.61424846","y: 0.61424846"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(205,153,216,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.20466483415084,1.20466483415084,null,1.20466483415084,0.95788286362071,null,0.95788286362071,0.95788286362071,null,0.95788286362071,0.794745500284792,null,0.794745500284792,0.794745500284792,null,0.794745500284792,0.381625693962732,null,0.381625693962732,0.381625693962732,null,0.381625693962732,0,null,0.381625693962732,0.381625693962732,null,0.381625693962732,0,null,0.794745500284792,0.794745500284792,null,0.794745500284792,0.666404776934707,null,0.666404776934707,0.666404776934707,null,0.666404776934707,0.367061621439879,null,0.367061621439879,0.367061621439879,null,0.367061621439879,0,null,0.367061621439879,0.367061621439879,null,0.367061621439879,0.248285826616636,null,0.248285826616636,0.248285826616636,null,0.248285826616636,0.087558107117794,null,0.087558107117794,0.087558107117794,null,0.087558107117794,0,null,0.087558107117794,0.087558107117794,null,0.087558107117794,0,null,0.248285826616636,0.248285826616636,null,0.248285826616636,0.237569649714429,null,0.237569649714429,0.237569649714429,null,0.237569649714429,0.129904663635189,null,0.129904663635189,0.129904663635189,null,0.129904663635189,0,null,0.129904663635189,0.129904663635189,null,0.129904663635189,0,null,0.237569649714429,0.237569649714429,null,0.237569649714429,0,null,0.666404776934707,0.666404776934707,null,0.666404776934707,0.534875118690448,null,0.534875118690448,0.534875118690448,null,0.534875118690448,0.438363599370831,null,0.438363599370831,0.438363599370831,null,0.438363599370831,0.20347407832471,null,0.20347407832471,0.20347407832471,null,0.20347407832471,0,null,0.20347407832471,0.20347407832471,null,0.20347407832471,0,null,0.438363599370831,0.438363599370831,null,0.438363599370831,0.332059186086582,null,0.332059186086582,0.332059186086582,null,0.332059186086582,0.274199290988404,null,0.274199290988404,0.274199290988404,null,0.274199290988404,0,null,0.274199290988404,0.274199290988404,null,0.274199290988404,0.143438256757787,null,0.143438256757787,0.143438256757787,null,0.143438256757787,0,null,0.143438256757787,0.143438256757787,null,0.143438256757787,0,null,0.332059186086582,0.332059186086582,null,0.332059186086582,0.20894513119211,null,0.20894513119211,0.20894513119211,null,0.20894513119211,0,null,0.20894513119211,0.20894513119211,null,0.20894513119211,0.154458411843452,null,0.154458411843452,0.154458411843452,null,0.154458411843452,0.0903999281103317,null,0.0903999281103317,0.0903999281103317,null,0.0903999281103317,0,null,0.0903999281103317,0.0903999281103317,null,0.0903999281103317,0,null,0.154458411843452,0.154458411843452,null,0.154458411843452,0,null,0.534875118690448,0.534875118690448,null,0.534875118690448,0.372123275507687,null,0.372123275507687,0.372123275507687,null,0.372123275507687,0.35032421362806,null,0.35032421362806,0.35032421362806,null,0.35032421362806,0.243402838861005,null,0.243402838861005,0.243402838861005,null,0.243402838861005,0.212443162483461,null,0.212443162483461,0.212443162483461,null,0.212443162483461,0.127081711167596,null,0.127081711167596,0.127081711167596,null,0.127081711167596,0,null,0.127081711167596,0.127081711167596,null,0.127081711167596,0,null,0.212443162483461,0.212443162483461,null,0.212443162483461,0,null,0.243402838861005,0.243402838861005,null,0.243402838861005,0,null,0.35032421362806,0.35032421362806,null,0.35032421362806,0,null,0.372123275507687,0.372123275507687,null,0.372123275507687,0.182577335771184,null,0.182577335771184,0.182577335771184,null,0.182577335771184,0,null,0.182577335771184,0.182577335771184,null,0.182577335771184,0.121298312556643,null,0.121298312556643,0.121298312556643,null,0.121298312556643,0,null,0.121298312556643,0.121298312556643,null,0.121298312556643,0.0949020854651997,null,0.0949020854651997,0.0949020854651997,null,0.0949020854651997,0,null,0.0949020854651997,0.0949020854651997,null,0.0949020854651997,0,null,0.95788286362071,0.95788286362071,null,0.95788286362071,0.407830626686954,null,0.407830626686954,0.407830626686954,null,0.407830626686954,0.218154484501403,null,0.218154484501403,0.218154484501403,null,0.218154484501403,0.0991867532043192,null,0.0991867532043192,0.0991867532043192,null,0.0991867532043192,0,null,0.0991867532043192,0.0991867532043192,null,0.0991867532043192,0,null,0.218154484501403,0.218154484501403,null,0.218154484501403,0,null,0.407830626686954,0.407830626686954,null,0.407830626686954,0.319599624724541,null,0.319599624724541,0.319599624724541,null,0.319599624724541,0.209182472124278,null,0.209182472124278,0.209182472124278,null,0.209182472124278,0,null,0.209182472124278,0.209182472124278,null,0.209182472124278,0,null,0.319599624724541,0.319599624724541,null,0.319599624724541,0.119504801735496,null,0.119504801735496,0.119504801735496,null,0.119504801735496,0,null,0.119504801735496,0.119504801735496,null,0.119504801735496,0],"y":[27.923828125,17.98828125,null,17.98828125,17.98828125,null,17.98828125,6.1015625,null,6.1015625,6.1015625,null,6.1015625,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,6.1015625,10.703125,null,10.703125,10.703125,null,10.703125,4.4375,null,4.4375,4.4375,null,4.4375,3,null,3,3,null,4.4375,5.875,null,5.875,5.875,null,5.875,4.5,null,4.5,4.5,null,4.5,4,null,4,4,null,4.5,5,null,5,5,null,5.875,7.25,null,7.25,7.25,null,7.25,6.5,null,6.5,6.5,null,6.5,6,null,6,6,null,6.5,7,null,7,7,null,7.25,8,null,8,8,null,10.703125,16.96875,null,16.96875,16.96875,null,16.96875,11.46875,null,11.46875,11.46875,null,11.46875,9.5,null,9.5,9.5,null,9.5,9,null,9,9,null,9.5,10,null,10,10,null,11.46875,13.4375,null,13.4375,13.4375,null,13.4375,11.75,null,11.75,11.75,null,11.75,11,null,11,11,null,11.75,12.5,null,12.5,12.5,null,12.5,12,null,12,12,null,12.5,13,null,13,13,null,13.4375,15.125,null,15.125,15.125,null,15.125,14,null,14,14,null,15.125,16.25,null,16.25,16.25,null,16.25,15.5,null,15.5,15.5,null,15.5,15,null,15,15,null,15.5,16,null,16,16,null,16.25,17,null,17,17,null,16.96875,22.46875,null,22.46875,22.46875,null,22.46875,21.0625,null,21.0625,21.0625,null,21.0625,20.125,null,20.125,20.125,null,20.125,19.25,null,19.25,19.25,null,19.25,18.5,null,18.5,18.5,null,18.5,18,null,18,18,null,18.5,19,null,19,19,null,19.25,20,null,20,20,null,20.125,21,null,21,21,null,21.0625,22,null,22,22,null,22.46875,23.875,null,23.875,23.875,null,23.875,23,null,23,23,null,23.875,24.75,null,24.75,24.75,null,24.75,24,null,24,24,null,24.75,25.5,null,25.5,25.5,null,25.5,25,null,25,25,null,25.5,26,null,26,26,null,17.98828125,29.875,null,29.875,29.875,null,29.875,28.25,null,28.25,28.25,null,28.25,27.5,null,27.5,27.5,null,27.5,27,null,27,27,null,27.5,28,null,28,28,null,28.25,29,null,29,29,null,29.875,31.5,null,31.5,31.5,null,31.5,30.5,null,30.5,30.5,null,30.5,30,null,30,30,null,30.5,31,null,31,31,null,31.5,32.5,null,32.5,32.5,null,32.5,32,null,32,32,null,32.5,33,null,33,33],"text":["y: 1.20466483","y: 1.20466483",null,"y: 1.20466483","y: 1.20466483",null,"y: 0.95788286","y: 0.95788286",null,"y: 0.95788286","y: 0.95788286",null,"y: 0.79474550","y: 0.79474550",null,"y: 0.79474550","y: 0.79474550",null,"y: 0.38162569","y: 0.38162569",null,"y: 0.38162569","y: 0.38162569",null,"y: 0.38162569","y: 0.38162569",null,"y: 0.38162569","y: 0.38162569",null,"y: 0.79474550","y: 0.79474550",null,"y: 0.79474550","y: 0.79474550",null,"y: 0.66640478","y: 0.66640478",null,"y: 0.66640478","y: 0.66640478",null,"y: 0.36706162","y: 0.36706162",null,"y: 0.36706162","y: 0.36706162",null,"y: 0.36706162","y: 0.36706162",null,"y: 0.36706162","y: 0.36706162",null,"y: 0.24828583","y: 0.24828583",null,"y: 0.24828583","y: 0.24828583",null,"y: 0.08755811","y: 0.08755811",null,"y: 0.08755811","y: 0.08755811",null,"y: 0.08755811","y: 0.08755811",null,"y: 0.08755811","y: 0.08755811",null,"y: 0.24828583","y: 0.24828583",null,"y: 0.24828583","y: 0.24828583",null,"y: 0.23756965","y: 0.23756965",null,"y: 0.23756965","y: 0.23756965",null,"y: 0.12990466","y: 0.12990466",null,"y: 0.12990466","y: 0.12990466",null,"y: 0.12990466","y: 0.12990466",null,"y: 0.12990466","y: 0.12990466",null,"y: 0.23756965","y: 0.23756965",null,"y: 0.23756965","y: 0.23756965",null,"y: 0.66640478","y: 0.66640478",null,"y: 0.66640478","y: 0.66640478",null,"y: 0.53487512","y: 0.53487512",null,"y: 0.53487512","y: 0.53487512",null,"y: 0.43836360","y: 0.43836360",null,"y: 0.43836360","y: 0.43836360",null,"y: 0.20347408","y: 0.20347408",null,"y: 0.20347408","y: 0.20347408",null,"y: 0.20347408","y: 0.20347408",null,"y: 0.20347408","y: 0.20347408",null,"y: 0.43836360","y: 0.43836360",null,"y: 0.43836360","y: 0.43836360",null,"y: 0.33205919","y: 0.33205919",null,"y: 0.33205919","y: 0.33205919",null,"y: 0.27419929","y: 0.27419929",null,"y: 0.27419929","y: 0.27419929",null,"y: 0.27419929","y: 0.27419929",null,"y: 0.27419929","y: 0.27419929",null,"y: 0.14343826","y: 0.14343826",null,"y: 0.14343826","y: 0.14343826",null,"y: 0.14343826","y: 0.14343826",null,"y: 0.14343826","y: 0.14343826",null,"y: 0.33205919","y: 0.33205919",null,"y: 0.33205919","y: 0.33205919",null,"y: 0.20894513","y: 0.20894513",null,"y: 0.20894513","y: 0.20894513",null,"y: 0.20894513","y: 0.20894513",null,"y: 0.20894513","y: 0.20894513",null,"y: 0.15445841","y: 0.15445841",null,"y: 0.15445841","y: 0.15445841",null,"y: 0.09039993","y: 0.09039993",null,"y: 0.09039993","y: 0.09039993",null,"y: 0.09039993","y: 0.09039993",null,"y: 0.09039993","y: 0.09039993",null,"y: 0.15445841","y: 0.15445841",null,"y: 0.15445841","y: 0.15445841",null,"y: 0.53487512","y: 0.53487512",null,"y: 0.53487512","y: 0.53487512",null,"y: 0.37212328","y: 0.37212328",null,"y: 0.37212328","y: 0.37212328",null,"y: 0.35032421","y: 0.35032421",null,"y: 0.35032421","y: 0.35032421",null,"y: 0.24340284","y: 0.24340284",null,"y: 0.24340284","y: 0.24340284",null,"y: 0.21244316","y: 0.21244316",null,"y: 0.21244316","y: 0.21244316",null,"y: 0.12708171","y: 0.12708171",null,"y: 0.12708171","y: 0.12708171",null,"y: 0.12708171","y: 0.12708171",null,"y: 0.12708171","y: 0.12708171",null,"y: 0.21244316","y: 0.21244316",null,"y: 0.21244316","y: 0.21244316",null,"y: 0.24340284","y: 0.24340284",null,"y: 0.24340284","y: 0.24340284",null,"y: 0.35032421","y: 0.35032421",null,"y: 0.35032421","y: 0.35032421",null,"y: 0.37212328","y: 0.37212328",null,"y: 0.37212328","y: 0.37212328",null,"y: 0.18257734","y: 0.18257734",null,"y: 0.18257734","y: 0.18257734",null,"y: 0.18257734","y: 0.18257734",null,"y: 0.18257734","y: 0.18257734",null,"y: 0.12129831","y: 0.12129831",null,"y: 0.12129831","y: 0.12129831",null,"y: 0.12129831","y: 0.12129831",null,"y: 0.12129831","y: 0.12129831",null,"y: 0.09490209","y: 0.09490209",null,"y: 0.09490209","y: 0.09490209",null,"y: 0.09490209","y: 0.09490209",null,"y: 0.09490209","y: 0.09490209",null,"y: 0.95788286","y: 0.95788286",null,"y: 0.95788286","y: 0.95788286",null,"y: 0.40783063","y: 0.40783063",null,"y: 0.40783063","y: 0.40783063",null,"y: 0.21815448","y: 0.21815448",null,"y: 0.21815448","y: 0.21815448",null,"y: 0.09918675","y: 0.09918675",null,"y: 0.09918675","y: 0.09918675",null,"y: 0.09918675","y: 0.09918675",null,"y: 0.09918675","y: 0.09918675",null,"y: 0.21815448","y: 0.21815448",null,"y: 0.21815448","y: 0.21815448",null,"y: 0.40783063","y: 0.40783063",null,"y: 0.40783063","y: 0.40783063",null,"y: 0.31959962","y: 0.31959962",null,"y: 0.31959962","y: 0.31959962",null,"y: 0.20918247","y: 0.20918247",null,"y: 0.20918247","y: 0.20918247",null,"y: 0.20918247","y: 0.20918247",null,"y: 0.20918247","y: 0.20918247",null,"y: 0.31959962","y: 0.31959962",null,"y: 0.31959962","y: 0.31959962",null,"y: 0.11950480","y: 0.11950480",null,"y: 0.11950480","y: 0.11950480",null,"y: 0.11950480","y: 0.11950480",null,"y: 0.11950480","y: 0.11950480"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.82287715348419,1.82287715348419,null,1.82287715348419,1.20466483415084,null,1.20466483415084,1.20466483415084,null,1.20466483415084,1.05439722722438,null,1.82287715348419,1.82287715348419,null,1.82287715348419,1.59417446669873,null,1.59417446669873,1.59417446669873,null,1.59417446669873,1.09087788975901],"y":[38.9267578125,27.923828125,null,27.923828125,27.923828125,null,27.923828125,37.859375,null,37.859375,37.859375,null,38.9267578125,49.9296875,null,49.9296875,49.9296875,null,49.9296875,45.609375,null,45.609375,45.609375],"text":["y: 1.82287715","y: 1.82287715",null,"y: 1.82287715","y: 1.82287715",null,"y: 1.20466483","y: 1.20466483",null,"y: 1.20466483","y: 1.20466483",null,"y: 1.82287715","y: 1.82287715",null,"y: 1.82287715","y: 1.82287715",null,"y: 1.59417447","y: 1.59417447",null,"y: 1.59417447","y: 1.59417447"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.82287715348419,1.20466483415084,0.95788286362071,0.794745500284792,0.381625693962732,0,0,0.666404776934707,0.367061621439879,0,0.248285826616636,0.087558107117794,0,0,0.237569649714429,0.129904663635189,0,0,0,0.534875118690448,0.438363599370831,0.20347407832471,0,0,0.332059186086582,0.274199290988404,0,0.143438256757787,0,0,0.20894513119211,0,0.154458411843452,0.0903999281103317,0,0,0,0.372123275507687,0.35032421362806,0.243402838861005,0.212443162483461,0.127081711167596,0,0,0,0,0,0.182577335771184,0,0.121298312556643,0,0.0949020854651997,0,0,0.407830626686954,0.218154484501403,0.0991867532043192,0,0,0,0.319599624724541,0.209182472124278,0,0,0.119504801735496,0,0,1.05439722722438,0.659367031899142,0,0.366446818172613,0,0.257294381800551,0.202445065633869,0,0.128883042294223,0,0,0,0.47350573521867,0,0,1.59417446669873,1.09087788975901,0.500949721963311,0,0,0.731800222126064,0.691159533269081,0.380627098188748,0.255264316891836,0,0.185675404080306,0,0,0,0,0.466807582689693,0.358417482296683,0,0,0.173019976310583,0,0,0.614248456260233,0.275857868808986,0,0,0],"y":[38.9267578125,27.923828125,17.98828125,6.1015625,1.5,1,2,10.703125,4.4375,3,5.875,4.5,4,5,7.25,6.5,6,7,8,16.96875,11.46875,9.5,9,10,13.4375,11.75,11,12.5,12,13,15.125,14,16.25,15.5,15,16,17,22.46875,21.0625,20.125,19.25,18.5,18,19,20,21,22,23.875,23,24.75,24,25.5,25,26,29.875,28.25,27.5,27,28,29,31.5,30.5,30,31,32.5,32,33,37.859375,35.21875,34,36.4375,35,37.875,36.75,36,37.5,37,38,39,40.5,40,41,49.9296875,45.609375,42.5,42,43,48.71875,46.9375,45.875,44.75,44,45.5,45,46,47,48,50.5,49.5,49,50,51.5,51,52,54.25,53.5,53,54,55],"text":["y: 1.82287715","y: 1.20466483","y: 0.95788286","y: 0.79474550","y: 0.38162569","y: 0.00000000","y: 0.00000000","y: 0.66640478","y: 0.36706162","y: 0.00000000","y: 0.24828583","y: 0.08755811","y: 0.00000000","y: 0.00000000","y: 0.23756965","y: 0.12990466","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.53487512","y: 0.43836360","y: 0.20347408","y: 0.00000000","y: 0.00000000","y: 0.33205919","y: 0.27419929","y: 0.00000000","y: 0.14343826","y: 0.00000000","y: 0.00000000","y: 0.20894513","y: 0.00000000","y: 0.15445841","y: 0.09039993","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.37212328","y: 0.35032421","y: 0.24340284","y: 0.21244316","y: 0.12708171","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.18257734","y: 0.00000000","y: 0.12129831","y: 0.00000000","y: 0.09490209","y: 0.00000000","y: 0.00000000","y: 0.40783063","y: 0.21815448","y: 0.09918675","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.31959962","y: 0.20918247","y: 0.00000000","y: 0.00000000","y: 0.11950480","y: 0.00000000","y: 0.00000000","y: 1.05439723","y: 0.65936703","y: 0.00000000","y: 0.36644682","y: 0.00000000","y: 0.25729438","y: 0.20244507","y: 0.00000000","y: 0.12888304","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.47350574","y: 0.00000000","y: 0.00000000","y: 1.59417447","y: 1.09087789","y: 0.50094972","y: 0.00000000","y: 0.00000000","y: 0.73180022","y: 0.69115953","y: 0.38062710","y: 0.25526432","y: 0.00000000","y: 0.18567540","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.46680758","y: 0.35841748","y: 0.00000000","y: 0.00000000","y: 0.17301998","y: 0.00000000","y: 0.00000000","y: 0.61424846","y: 0.27585787","y: 0.00000000","y: 0.00000000","y: 0.00000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"xaxis":{"domain":[0,0.8],"automargin":true,"type":"linear","autorange":false,"range":[0.5,5.5],"tickmode":"array","ticktext":["RADIO_PR","TV_PR","LLPHONE_PR","MPHONE_PR","COMPUTER_PR"],"tickvals":[1,2,3,4,5],"categoryorder":"array","categoryarray":["RADIO_PR","TV_PR","LLPHONE_PR","MPHONE_PR","COMPUTER_PR"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":6.6417600664176},"tickangle":-45,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"ICT Indicators","hoverformat":".2f"},"xaxis2":{"domain":[0.8,1],"automargin":true,"type":"linear","autorange":false,"range":[0,1.82287715348419],"tickmode":"array","ticktext":["0.0","0.5","1.0","1.5"],"tickvals":[0,0.5,1,1.5],"categoryorder":"array","categoryarray":["0.0","0.5","1.0","1.5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":null,"family":null,"size":0}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.5,55.5],"tickmode":"array","ticktext":["Narphan","Pangwaun","Mongpan","Nansang","Kyaukme","Kalaw","Hseni","Langkho","Kunhing","Laihka","Monghsat","Loilen","Mongnai","Mongton","Hsipaw","Hopong","Monghsu","Pinlaung","Mongmit","Pekon","Kutkai","Namtu","Hsihseng","Kyethi","Tangyan","Namhsan","Mongyai","Mongping","Mongkhet","Mawkmai","Mongkaing","Manton","Matman","Ywangan","Pindaya","Lawksawk","Nyaungshwe","Nawnghkio","Monghpyak","Mabein","Mongyawng","Kunlong","Konkyan","Mongyang","Mongmao","Hopang","Namhkan","Laukkaing","Mongla","Pangsang","Kengtung","Lashio","Taunggyi","Tachileik","Muse"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55],"categoryorder":"array","categoryarray":["Narphan","Pangwaun","Mongpan","Nansang","Kyaukme","Kalaw","Hseni","Langkho","Kunhing","Laihka","Monghsat","Loilen","Mongnai","Mongton","Hsipaw","Hopong","Monghsu","Pinlaung","Mongmit","Pekon","Kutkai","Namtu","Hsihseng","Kyethi","Tangyan","Namhsan","Mongyai","Mongping","Mongkhet","Mawkmai","Mongkaing","Manton","Matman","Ywangan","Pindaya","Lawksawk","Nyaungshwe","Nawnghkio","Monghpyak","Mabein","Mongyawng","Kunlong","Konkyan","Mongyang","Mongmao","Hopang","Namhkan","Laukkaing","Mongla","Pangsang","Kengtung","Lashio","Taunggyi","Tachileik","Muse"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":5.31340805313408},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"Townships of Shan State","hoverformat":".2f"},"annotations":[],"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.8,"x1":1,"y0":0,"y1":1}],"images":[],"margin":{"t":60,"r":null,"b":35.0684931506849,"l":200},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"y":1,"yanchor":"top"},"hovermode":"closest","barmode":"relative","title":"Geographic Segmentation of Shan State by ICT indicators"},"attrs":{"ef84858348d":{"x":{},"y":{},"fill":{},"text":{},"type":"heatmap"},"ef868024962":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"scatter"},"ef8312078d8":{"colour":{},"shape":{},"size":{},"x":{},"y":{}}},"source":"A","config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>If we are happy with the 6 clusters formed, we can save the cluster assignments to the dataset and map them out. <code>cutree()</code> function extracts the cluster assignments</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">cutree</span>(hclust_ward, <span class="at">k=</span><span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following code chunk combines the cluster assignments to shan_sf dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>shan_sf_cluster <span class="ot">&lt;-</span> <span class="fu">cbind</span>(shan_sf, <span class="fu">as.matrix</span>(groups)) <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">CLUSTER</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">as.matrix.groups.</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can plot it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(shan_sf_cluster, <span class="st">"CLUSTER"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Hands-on_EX03_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The clusters are fragmented spatially. This is one of the motivations for spatially constrained clustering.</p>
</section>
</section>
<section id="spatially-constrained-clustering" class="level2">
<h2 class="anchored" data-anchor-id="spatially-constrained-clustering">5. Spatially Constrained Clustering</h2>
<p>First, we need to convert <code>shan_sf</code> into SpatialPolygonsDataFrame. This is because the <code>skater()</code> function only support <strong>sp</strong> objects such as SpatialPolygonDataFrame.</p>
<p>The code chunk below uses <u><code>as_Spatial()</code></u> of <strong>sf</strong> package to convert shan_sf into a SpatialPolygonDataFrame called shan_sp.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>shan_sp <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(shan_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="defining-the-neighbourhood" class="level3">
<h3 class="anchored" data-anchor-id="defining-the-neighbourhood">Defining the Neighbourhood</h3>
<p>As always, we must define the neighbourhood (neighbour list). We will be using a queen contiguity matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>shan.nb <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(shan_sp, <span class="at">queen=</span><span class="cn">TRUE</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(shan.nb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 55 
Number of nonzero links: 264 
Percentage nonzero weights: 8.727273 
Average number of links: 4.8 
Link number distribution:

 2  3  4  5  6  7  8  9 
 5  9  7 21  4  3  5  1 
5 least connected regions:
3 5 7 9 47 with 2 links
1 most connected region:
8 with 9 links</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shan_sp, </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">border=</span><span class="fu">grey</span>(.<span class="dv">5</span>))</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shan.nb, </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">coordinates</span>(shan_sp), </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="st">"blue"</span>, </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Hands-on_EX03_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="computing-the-minimum-spanning-tree" class="level3">
<h3 class="anchored" data-anchor-id="computing-the-minimum-spanning-tree">Computing the Minimum Spanning Tree</h3>
<p>A spanning tree of an undirected graph (such as the connectivity network above) with V vertices (nodes) refers to a subgraph with V-1 edges such that all vertices are still connected to each other. The minimum spanning tree refers to a spanning tree with the lowest total cost if the edges are weighted.</p>
<p>To compute the minimum spanning tree, we must first weigh the edges with a cost. The code chunk below computes the “cost” of an edge which is pairwise dissimilarity between neighbours’ values on the five variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>lcosts <span class="ot">&lt;-</span> <span class="fu">nbcosts</span>(shan.nb, shan_ict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can assign the costs to the neighbour list to create the spatial weight matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>shan.w <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(shan.nb,</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">glist=</span>lcosts,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">style=</span><span class="st">"B"</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(shan.w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 55 
Number of nonzero links: 264 
Percentage nonzero weights: 8.727273 
Average number of links: 4.8 
Link number distribution:

 2  3  4  5  6  7  8  9 
 5  9  7 21  4  3  5  1 
5 least connected regions:
3 5 7 9 47 with 2 links
1 most connected region:
8 with 9 links

Weights style: B 
Weights constants summary:
   n   nn       S0       S1      S2
B 55 3025 8208.527 672291.1 6039513</code></pre>
</div>
</div>
<p>We can now calculate the minimum spanning tree using the <code>mstree()</code> function of the <strong>spdep</strong> package. As the minimum spanning tree only has v-1 edges, the dimension of the shan.mst object is only 54, not 55 which is the total number of townships in Shan state.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>shan.mst <span class="ot">&lt;-</span> <span class="fu">mstree</span>(shan.w)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(shan.mst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 54  3</code></pre>
</div>
</div>
<p>We can plot the minimum spanning tree using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shan_sp, <span class="at">border=</span><span class="fu">gray</span>(.<span class="dv">5</span>))</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.mst</span>(shan.mst, </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">coordinates</span>(shan_sp), </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span><span class="st">"blue"</span>, </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex.lab=</span><span class="fl">0.7</span>, </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex.circles=</span><span class="fl">0.005</span>, </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Hands-on_EX03_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="computing-spatially-constrained-clusters-using-skater-method" class="level3">
<h3 class="anchored" data-anchor-id="computing-spatially-constrained-clusters-using-skater-method">Computing Spatially Constrained Clusters Using SKATER Method</h3>
<p>The code chunk below computes the spatially constrained clusters using the SKATER method. It takes the edges from the minimum spanning tree (not the costs!) and the actual data containing the variable considered. It performs n cuts to get n+1 number of clusters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>clust6 <span class="ot">&lt;-</span> <span class="fu">skater</span>(<span class="at">edges =</span> shan.mst[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> shan_ict, </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"euclidean"</span>, </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ncuts =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>clust6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$groups
 [1] 6 6 6 6 6 6 4 6 6 6 1 6 6 6 1 3 6 6 6 3 6 2 6 5 6 2 6 6 6 6 1 5 1 6 6 4 6 2
[39] 1 6 6 1 5 6 6 6 6 6 6 1 5 6 2 6 6

$edges.groups
$edges.groups[[1]]
$edges.groups[[1]]$node
[1] 31 50 11 15 39 42 33

$edges.groups[[1]]$edge
     [,1] [,2]      [,3]
[1,]   11   42 34.387764
[2,]   50   39 29.755406
[3,]   15   33 17.106583
[4,]   15   11 13.743768
[5,]   31   50  7.396972
[6,]   50   15  2.147665

$edges.groups[[1]]$ssw
[1] 118.5374


$edges.groups[[2]]
$edges.groups[[2]]$node
[1] 22 53 26 38

$edges.groups[[2]]$edge
     [,1] [,2]      [,3]
[1,]   53   38 18.917358
[2,]   22   26 11.786692
[3,]   22   53  4.064893

$edges.groups[[2]]$ssw
[1] 67.88651


$edges.groups[[3]]
$edges.groups[[3]]$node
[1] 20 16

$edges.groups[[3]]$edge
     [,1] [,2]     [,3]
[1,]   20   16 13.32999

$edges.groups[[3]]$ssw
[1] 13.32999


$edges.groups[[4]]
$edges.groups[[4]]$node
[1] 36  7

$edges.groups[[4]]$edge
     [,1] [,2]     [,3]
[1,]   36    7 30.61638

$edges.groups[[4]]$ssw
[1] 30.61638


$edges.groups[[5]]
$edges.groups[[5]]$node
[1] 24 43 51 32

$edges.groups[[5]]$edge
     [,1] [,2]      [,3]
[1,]   43   32 30.912416
[2,]   24   43  9.778470
[3,]   24   51  8.255919

$edges.groups[[5]]$ssw
[1] 57.98259


$edges.groups[[6]]
$edges.groups[[6]]$node
 [1] 10 25 52 23 14  8 28 55 17 19 18 41 30  6 34  1 13  2 21 12 45 27 47 49 35
[26] 48 46 40 54 37 44  4  5  3 29  9

$edges.groups[[6]]$edge
      [,1] [,2]      [,3]
 [1,]   52   45 38.112866
 [2,]   23   47 35.957910
 [3,]   28   52 34.681180
 [4,]   23   27 30.824975
 [5,]   14   49 30.447476
 [6,]    8    6 29.038187
 [7,]   10   55 28.833161
 [8,]    8   35 27.842807
 [9,]   55    1 23.082290
[10,]   18   48 22.447653
[11,]   19   41 20.867009
[12,]   14   37 20.236457
[13,]    6    4 19.765479
[14,]   41   40 19.225948
[15,]   30   54 18.961970
[16,]   14   44 18.676071
[17,]    8   46 18.650776
[18,]    8   18 16.488288
[19,]    2    3 16.131465
[20,]   19   17 13.285066
[21,]    1    5 11.242824
[22,]   18   12 10.682115
[23,]   12   28 10.614852
[24,]   34   21 10.168055
[25,]   10    9  9.180481
[26,]   25   10  8.169645
[27,]   17   25  7.871804
[28,]   13   34  7.083237
[29,]   41   29  7.065738
[30,]   28   14  6.552019
[31,]    8    2  5.384161
[32,]   21   30  4.928689
[33,]   30   23  3.847340
[34,]   14   13  3.693718
[35,]   10    8  1.195515

$edges.groups[[6]]$ssw
[1] 638.2814



$not.prune
NULL

$candidates
[1] 1 2 3 4 5 6

$ssto
[1] 1261.252

$ssw
[1] 1261.2515 1139.7426 1067.6608 1016.9978  965.8793  926.6342

$crit
[1]   1 Inf

$vec.crit
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
[39] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1

attr(,"class")
[1] "skater"</code></pre>
</div>
</div>
<p>We can find the number of townships within each cluster using the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(clust6<span class="sc">$</span>groups)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 1  2  3  4  5  6 
 7  4  2  2  4 36 </code></pre>
</div>
</div>
<p>Of course, we should also plot the clusters spatially to see the result:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shan_sp, <span class="at">border=</span><span class="fu">gray</span>(.<span class="dv">5</span>))</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clust6, </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">coordinates</span>(shan_sp), </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab=</span>.<span class="dv">7</span>,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">groups.colors=</span><span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"green"</span> ,<span class="st">"blue"</span>, <span class="st">"brown"</span>, <span class="st">"pink"</span>, <span class="st">"orange"</span>),</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.circles=</span><span class="fl">0.005</span>,</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Hands-on_EX03_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>groups_mat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(clust6<span class="sc">$</span>groups)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>shan_sf_spatialcluster <span class="ot">&lt;-</span> <span class="fu">cbind</span>(shan_sf_cluster, </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">as.factor</span>(groups_mat)) <span class="sc">%&gt;%</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">SP_CLUSTER</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">as.factor.groups_mat.</span><span class="st">`</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(shan_sf_spatialcluster, <span class="st">"SP_CLUSTER"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Hands-on_EX03_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can also use the ggparcoord function from the GGally package to plot a parallel coordinates plot to examine the distribution of the variables in each cluster.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(<span class="at">data=</span> shan_sf_spatialcluster,</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">columns=</span><span class="fu">c</span>(<span class="dv">25</span><span class="sc">:</span><span class="dv">29</span>),</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">as.factor</span>(<span class="st">`</span><span class="at">SP_CLUSTER</span><span class="st">`</span>)),</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale=</span><span class="st">"uniminmax"</span>,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">alphaLines =</span> <span class="fl">0.5</span>,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">boxplot=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Parallel Coordinates Plots of Technology Penetration by Spatial Clusters"</span>,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Standardised using Min-Max Normalisation"</span>,</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"% Household Penetration"</span>) <span class="sc">+</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_brewer</span>(<span class="at">name=</span><span class="st">"Cluster"</span>,</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">levels</span>(shan_sf_spatialcluster<span class="sc">$</span><span class="st">`</span><span class="at">SP_CLUSTER</span><span class="st">`</span>),</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> SP_CLUSTER)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Hands-on_EX03_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>